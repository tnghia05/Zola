"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/call/page",{

/***/ "(app-pages-browser)/../../packages/app/hooks/useLiveKit.ts":
/*!**********************************************!*\
  !*** ../../packages/app/hooks/useLiveKit.ts ***!
  \**********************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   useLiveKit: function() { return /* binding */ useLiveKit; }\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"(app-pages-browser)/../../node_modules/.pnpm/next@14.0.4_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/next/dist/compiled/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var livekit_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! livekit-client */ \"(app-pages-browser)/../../node_modules/.pnpm/livekit-client@2.16.0_@types+dom-mediacapture-record@1.0.22/node_modules/livekit-client/dist/livekit-client.esm.mjs\");\n\n\nfunction useLiveKit(param) {\n    let { roomName, token, url, autoSubscribe = true } = param;\n    const [room, setRoom] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null);\n    const [localStream, setLocalStream] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null);\n    const [remoteStreams, setRemoteStreams] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(new Map());\n    const [remoteTracks, setRemoteTracks] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(new Map());\n    const [isConnected, setIsConnected] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);\n    const [error, setError] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null);\n    const [isVideoEnabled, setIsVideoEnabled] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(true);\n    const [isAudioEnabled, setIsAudioEnabled] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(true);\n    const roomRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);\n    const connectPromiseRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);\n    const latestOptionsRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)({\n        roomName,\n        token,\n        url\n    });\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{\n        latestOptionsRef.current = {\n            roomName,\n            token,\n            url\n        };\n    }, [\n        roomName,\n        token,\n        url\n    ]);\n    const buildMediaStreamFromLocal = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((currentRoom)=>{\n        try {\n            const publications = Array.from(currentRoom.localParticipant.trackPublications.values());\n            const tracks = [];\n            publications.forEach((pub)=>{\n                const lkTrack = pub.track;\n                if (lkTrack && (lkTrack instanceof livekit_client__WEBPACK_IMPORTED_MODULE_1__.LocalVideoTrack || lkTrack instanceof livekit_client__WEBPACK_IMPORTED_MODULE_1__.LocalAudioTrack)) {\n                    const mediaTrack = lkTrack.mediaStreamTrack;\n                    if (mediaTrack) {\n                        tracks.push(mediaTrack);\n                    }\n                }\n            });\n            if (tracks.length > 0) {\n                const stream = new MediaStream(tracks);\n                setLocalStream(stream);\n            }\n        } catch (err) {\n            console.warn(\"[LiveKit] Failed to build local stream:\", err);\n        }\n    }, []);\n    const addRemoteTrack = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((participantId, mediaTrack)=>{\n        setRemoteStreams((prev)=>{\n            const next = new Map(prev);\n            const existing = next.get(participantId);\n            // Create a NEW MediaStream with all existing tracks + new track\n            // This ensures React detects the state change\n            const allTracks = [];\n            if (existing) {\n                existing.getTracks().forEach((t)=>{\n                    if (t.id !== mediaTrack.id) {\n                        allTracks.push(t);\n                    }\n                });\n            }\n            allTracks.push(mediaTrack);\n            const newStream = new MediaStream(allTracks);\n            next.set(participantId, newStream);\n            console.log(\"[LiveKit] Remote streams updated:\", {\n                participantId,\n                newTrackKind: mediaTrack.kind,\n                totalTracks: newStream.getTracks().length,\n                mapSize: next.size\n            });\n            return next;\n        });\n    }, []);\n    const removeRemoteTrack = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((participantId, mediaTrack)=>{\n        setRemoteStreams((prev)=>{\n            const next = new Map(prev);\n            const existing = next.get(participantId);\n            if (!existing) return prev;\n            if (mediaTrack) {\n                existing.removeTrack(mediaTrack);\n            }\n            if (existing.getTracks().length === 0) {\n                next.delete(participantId);\n            } else {\n                next.set(participantId, existing);\n            }\n            return next;\n        });\n    }, []);\n    const disconnect = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(()=>{\n        if (roomRef.current) {\n            roomRef.current.disconnect();\n            roomRef.current = null;\n        }\n        connectPromiseRef.current = null;\n        setRoom(null);\n        setIsConnected(false);\n        setLocalStream(null);\n        setRemoteStreams(new Map());\n        setError(null);\n    }, []);\n    const connect = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(async ()=>{\n        const { roomName: currentRoomName, token: currentToken, url: currentUrl } = latestOptionsRef.current;\n        if (!currentRoomName || !currentToken || !currentUrl) {\n            setError(\"Thiếu th\\xf4ng tin LiveKit (room/token/url)\");\n            return;\n        }\n        if (roomRef.current && roomRef.current.state === \"connected\") {\n            return;\n        }\n        if (connectPromiseRef.current) {\n            return connectPromiseRef.current;\n        }\n        const promise = (async ()=>{\n            try {\n                setError(null);\n                const newRoom = new livekit_client__WEBPACK_IMPORTED_MODULE_1__.Room({\n                    adaptiveStream: true,\n                    dynacast: true\n                });\n                roomRef.current = newRoom;\n                setRoom(newRoom);\n                newRoom.on(livekit_client__WEBPACK_IMPORTED_MODULE_1__.RoomEvent.Connected, ()=>{\n                    setIsConnected(true);\n                });\n                newRoom.on(livekit_client__WEBPACK_IMPORTED_MODULE_1__.RoomEvent.Disconnected, ()=>{\n                    setIsConnected(false);\n                    setLocalStream(null);\n                    setRemoteStreams(new Map());\n                });\n                newRoom.on(livekit_client__WEBPACK_IMPORTED_MODULE_1__.RoomEvent.TrackSubscribed, (track, publication, participant)=>{\n                    console.log(\"[LiveKit] TrackSubscribed:\", {\n                        trackKind: track.kind,\n                        participantId: participant.identity,\n                        participantSid: participant.sid,\n                        trackSid: track.sid,\n                        isMuted: publication.isMuted,\n                        isSubscribed: publication.isSubscribed\n                    });\n                    if (track instanceof livekit_client__WEBPACK_IMPORTED_MODULE_1__.RemoteTrack) {\n                        // Store the RemoteTrack for direct attachment in components\n                        setRemoteTracks((prev)=>{\n                            const next = new Map(prev);\n                            const existing = next.get(participant.identity) || {};\n                            if (track.kind === \"video\") {\n                                next.set(participant.identity, {\n                                    ...existing,\n                                    videoTrack: track\n                                });\n                            } else if (track.kind === \"audio\") {\n                                next.set(participant.identity, {\n                                    ...existing,\n                                    audioTrack: track\n                                });\n                            }\n                            console.log(\"[LiveKit] Updated remoteTracks:\", {\n                                participantId: participant.identity,\n                                trackKind: track.kind,\n                                totalParticipants: next.size\n                            });\n                            return next;\n                        });\n                        // Also add to remoteStreams for backward compatibility\n                        const mediaTrack = track.mediaStreamTrack;\n                        if (mediaTrack) {\n                            console.log(\"[LiveKit] Adding remote MediaStreamTrack:\", {\n                                participantId: participant.identity,\n                                trackId: mediaTrack.id,\n                                trackKind: mediaTrack.kind,\n                                trackEnabled: mediaTrack.enabled,\n                                trackMuted: mediaTrack.muted\n                            });\n                            addRemoteTrack(participant.identity, mediaTrack);\n                        }\n                    }\n                });\n                // Handle track muted/unmuted events from remote participants\n                newRoom.on(livekit_client__WEBPACK_IMPORTED_MODULE_1__.RoomEvent.TrackMuted, (publication, participant)=>{\n                    console.log(\"[LiveKit] TrackMuted:\", {\n                        trackKind: publication.kind,\n                        participantId: participant.identity,\n                        source: publication.source\n                    });\n                });\n                newRoom.on(livekit_client__WEBPACK_IMPORTED_MODULE_1__.RoomEvent.TrackUnmuted, (publication, participant)=>{\n                    console.log(\"[LiveKit] TrackUnmuted:\", {\n                        trackKind: publication.kind,\n                        participantId: participant.identity,\n                        source: publication.source\n                    });\n                    // Re-add track when unmuted\n                    if (publication.track instanceof livekit_client__WEBPACK_IMPORTED_MODULE_1__.RemoteTrack) {\n                        const mediaTrack = publication.track.mediaStreamTrack;\n                        if (mediaTrack) {\n                            addRemoteTrack(participant.identity, mediaTrack);\n                        }\n                    }\n                });\n                newRoom.on(livekit_client__WEBPACK_IMPORTED_MODULE_1__.RoomEvent.ParticipantConnected, (participant)=>{\n                    console.log(\"[LiveKit] ParticipantConnected:\", {\n                        participantId: participant.identity,\n                        participantSid: participant.sid,\n                        trackCount: participant.trackPublications.size\n                    });\n                });\n                newRoom.on(livekit_client__WEBPACK_IMPORTED_MODULE_1__.RoomEvent.TrackUnsubscribed, (track, publication, participant)=>{\n                    if (track instanceof livekit_client__WEBPACK_IMPORTED_MODULE_1__.RemoteTrack) {\n                        const mediaTrack = track.mediaStreamTrack;\n                        removeRemoteTrack(participant.identity, mediaTrack);\n                    }\n                });\n                newRoom.on(livekit_client__WEBPACK_IMPORTED_MODULE_1__.RoomEvent.ParticipantDisconnected, (participant)=>{\n                    setRemoteStreams((prev)=>{\n                        const next = new Map(prev);\n                        next.delete(participant.identity);\n                        return next;\n                    });\n                });\n                console.log(\"[LiveKit] Connecting to room:\", currentRoomName, \"at URL:\", currentUrl);\n                await newRoom.connect(currentUrl, currentToken);\n                console.log(\"[LiveKit] Connected! Room state:\", newRoom.state);\n                console.log(\"[LiveKit] Remote participants:\", newRoom.remoteParticipants.size);\n                // Log existing remote participants\n                newRoom.remoteParticipants.forEach((participant, sid)=>{\n                    console.log(\"[LiveKit] Existing remote participant:\", {\n                        identity: participant.identity,\n                        sid: sid,\n                        trackCount: participant.trackPublications.size\n                    });\n                    // Subscribe to any existing tracks\n                    participant.trackPublications.forEach((pub)=>{\n                        if (pub.track && pub.track instanceof livekit_client__WEBPACK_IMPORTED_MODULE_1__.RemoteTrack) {\n                            const mediaTrack = pub.track.mediaStreamTrack;\n                            if (mediaTrack) {\n                                console.log(\"[LiveKit] Found existing remote track:\", {\n                                    participantId: participant.identity,\n                                    trackId: mediaTrack.id,\n                                    trackKind: mediaTrack.kind\n                                });\n                                addRemoteTrack(participant.identity, mediaTrack);\n                            }\n                        }\n                    });\n                });\n                await newRoom.localParticipant.enableCameraAndMicrophone();\n                console.log(\"[LiveKit] Camera and microphone enabled\");\n                buildMediaStreamFromLocal(newRoom);\n            } catch (err) {\n                console.error(\"[LiveKit] Error connecting:\", err);\n                setError((err === null || err === void 0 ? void 0 : err.message) || \"Kh\\xf4ng thể kết nối LiveKit\");\n                disconnect();\n            } finally{\n                connectPromiseRef.current = null;\n            }\n        })();\n        connectPromiseRef.current = promise;\n        return promise;\n    }, [\n        addRemoteTrack,\n        autoSubscribe,\n        buildMediaStreamFromLocal,\n        disconnect,\n        removeRemoteTrack\n    ]);\n    const toggleVideo = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(()=>{\n        if (!roomRef.current) return;\n        const enabled = !isVideoEnabled;\n        roomRef.current.localParticipant.setCameraEnabled(enabled);\n        setIsVideoEnabled(enabled);\n    }, [\n        isVideoEnabled\n    ]);\n    const toggleAudio = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(()=>{\n        if (!roomRef.current) return;\n        const enabled = !isAudioEnabled;\n        roomRef.current.localParticipant.setMicrophoneEnabled(enabled);\n        setIsAudioEnabled(enabled);\n    }, [\n        isAudioEnabled\n    ]);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{\n        return ()=>{\n            disconnect();\n        };\n    }, [\n        disconnect\n    ]);\n    return {\n        room,\n        localStream,\n        remoteStreams,\n        isConnected,\n        error,\n        connect,\n        disconnect,\n        toggleVideo,\n        toggleAudio,\n        isVideoEnabled,\n        isAudioEnabled\n    };\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uLi8uLi9wYWNrYWdlcy9hcHAvaG9va3MvdXNlTGl2ZUtpdC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQWlFO0FBQytCO0FBaUN6RixTQUFTUyxXQUFXLEtBS1A7UUFMTyxFQUN6QkMsUUFBUSxFQUNSQyxLQUFLLEVBQ0xDLEdBQUcsRUFDSEMsZ0JBQWdCLElBQUksRUFDRixHQUxPO0lBTXpCLE1BQU0sQ0FBQ0MsTUFBTUMsUUFBUSxHQUFHWiwrQ0FBUUEsQ0FBYztJQUM5QyxNQUFNLENBQUNhLGFBQWFDLGVBQWUsR0FBR2QsK0NBQVFBLENBQXFCO0lBQ25FLE1BQU0sQ0FBQ2UsZUFBZUMsaUJBQWlCLEdBQUdoQiwrQ0FBUUEsQ0FBMkIsSUFBSWlCO0lBQ2pGLE1BQU0sQ0FBQ0MsY0FBY0MsZ0JBQWdCLEdBQUduQiwrQ0FBUUEsQ0FBdUMsSUFBSWlCO0lBQzNGLE1BQU0sQ0FBQ0csYUFBYUMsZUFBZSxHQUFHckIsK0NBQVFBLENBQUM7SUFDL0MsTUFBTSxDQUFDc0IsT0FBT0MsU0FBUyxHQUFHdkIsK0NBQVFBLENBQWdCO0lBQ2xELE1BQU0sQ0FBQ3dCLGdCQUFnQkMsa0JBQWtCLEdBQUd6QiwrQ0FBUUEsQ0FBQztJQUNyRCxNQUFNLENBQUMwQixnQkFBZ0JDLGtCQUFrQixHQUFHM0IsK0NBQVFBLENBQUM7SUFFckQsTUFBTTRCLFVBQVU3Qiw2Q0FBTUEsQ0FBYztJQUNwQyxNQUFNOEIsb0JBQW9COUIsNkNBQU1BLENBQXVCO0lBQ3ZELE1BQU0rQixtQkFBbUIvQiw2Q0FBTUEsQ0FBQztRQUFFUTtRQUFVQztRQUFPQztJQUFJO0lBRXZEWCxnREFBU0EsQ0FBQztRQUNSZ0MsaUJBQWlCQyxPQUFPLEdBQUc7WUFBRXhCO1lBQVVDO1lBQU9DO1FBQUk7SUFDcEQsR0FBRztRQUFDRjtRQUFVQztRQUFPQztLQUFJO0lBRXpCLE1BQU11Qiw0QkFBNEJuQyxrREFBV0EsQ0FBQyxDQUFDb0M7UUFDN0MsSUFBSTtZQUNGLE1BQU1DLGVB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T0FBTyxLQUFJO2dCQUN6QnhDO1lBQ0YsU0FBVTtnQkFDUjlDLGtCQUFrQkUsT0FBTyxHQUFHO1lBQzlCO1FBQ0Y7UUFFQUYsa0JBQWtCRSxPQUFPLEdBQUdrRDtRQUM1QixPQUFPQTtJQUNULEdBQUc7UUFBQzNCO1FBQWdCNUM7UUFBZXNCO1FBQTJCMkM7UUFBWUg7S0FBa0I7SUFFNUYsTUFBTTRDLGNBQWN2SCxrREFBV0EsQ0FBQztRQUM5QixJQUFJLENBQUMrQixRQUFRRyxPQUFPLEVBQUU7UUFDdEIsTUFBTXdFLFVBQVUsQ0FBQy9FO1FBQ2pCSSxRQUFRRyxPQUFPLENBQUNNLGdCQUFnQixDQUFDZ0YsZ0JBQWdCLENBQUNkO1FBQ2xEOUUsa0JBQWtCOEU7SUFDcEIsR0FBRztRQUFDL0U7S0FBZTtJQUVuQixNQUFNOEYsY0FBY3pILGtEQUFXQSxDQUFDO1FBQzlCLElBQUksQ0FBQytCLFFBQVFHLE9BQU8sRUFBRTtRQUN0QixNQUFNd0UsVUFBVSxDQUFDN0U7UUFDakJFLFFBQVFHLE9BQU8sQ0FBQ00sZ0JBQWdCLENBQUNrRixvQkFBb0IsQ0FBQ2hCO1FBQ3RENUUsa0JBQWtCNEU7SUFDcEIsR0FBRztRQUFDN0U7S0FBZTtJQUVuQjVCLGdEQUFTQSxDQUFDO1FBQ1IsT0FBTztZQUNMNkU7UUFDRjtJQUNGLEdBQUc7UUFBQ0E7S0FBVztJQUVmLE9BQU87UUFDTGhFO1FBQ0FFO1FBQ0FFO1FBQ0FLO1FBQ0FFO1FBQ0FzRDtRQUNBRDtRQUNBeUM7UUFDQUU7UUFDQTlGO1FBQ0FFO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi4vLi4vcGFja2FnZXMvYXBwL2hvb2tzL3VzZUxpdmVLaXQudHM/MWUyMSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB1c2VDYWxsYmFjaywgdXNlRWZmZWN0LCB1c2VSZWYsIHVzZVN0YXRlIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgUm9vbSwgUm9vbUV2ZW50LCBSZW1vdGVUcmFjaywgTG9jYWxWaWRlb1RyYWNrLCBMb2NhbEF1ZGlvVHJhY2sgfSBmcm9tICdsaXZla2l0LWNsaWVudCc7XG5cbi8vIE5PVEU6IFRoaXMgaG9vayBpcyBub3cgd2ViLWZpcnN0LiBSZWFjdCBOYXRpdmUgZ2xvYmFscyByZWdpc3RyYXRpb24gaGFzIGJlZW5cbi8vIHJlbW92ZWQgdG8gYXZvaWQgYnVuZGxpbmcgJ3JlYWN0LW5hdGl2ZScgaW4gTmV4dC5qcy4gSWYgeW91IG5lZWQgbmF0aXZlXG4vLyBzdXBwb3J0IGxhdGVyLCBjcmVhdGUgYSBzZXBhcmF0ZSAndXNlTGl2ZUtpdC5uYXRpdmUudHMnIGltcGxlbWVudGF0aW9uLlxuXG5pbnRlcmZhY2UgVXNlTGl2ZUtpdE9wdGlvbnMge1xuICByb29tTmFtZT86IHN0cmluZztcbiAgdG9rZW4/OiBzdHJpbmc7XG4gIHVybD86IHN0cmluZztcbiAgYXV0b1N1YnNjcmliZT86IGJvb2xlYW47XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVtb3RlUGFydGljaXBhbnRUcmFja3Mge1xuICBhdWRpb1RyYWNrPzogUmVtb3RlVHJhY2s7XG4gIHZpZGVvVHJhY2s/OiBSZW1vdGVUcmFjaztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBVc2VMaXZlS2l0UmVzdWx0IHtcbiAgcm9vbTogUm9vbSB8IG51bGw7XG4gIGxvY2FsU3RyZWFtOiBNZWRpYVN0cmVhbSB8IG51bGw7XG4gIHJlbW90ZVN0cmVhbXM6IE1hcDxzdHJpbmcsIE1lZGlhU3RyZWFtPjtcbiAgcmVtb3RlVHJhY2tzOiBNYXA8c3RyaW5nLCBSZW1vdGVQYXJ0aWNpcGFudFRyYWNrcz47IC8vIE5ldzogZm9yIGRpcmVjdCB0cmFjayBhdHRhY2htZW50XG4gIGlzQ29ubmVjdGVkOiBib29sZWFuO1xuICBlcnJvcjogc3RyaW5nIHwgbnVsbDtcbiAgY29ubmVjdDogKCkgPT4gUHJvbWlzZTx2b2lkPjtcbiAgZGlzY29ubmVjdDogKCkgPT4gdm9pZDtcbiAgdG9nZ2xlVmlkZW86ICgpID0+IHZvaWQ7XG4gIHRvZ2dsZUF1ZGlvOiAoKSA9PiB2b2lkO1xuICBpc1ZpZGVvRW5hYmxlZDogYm9vbGVhbjtcbiAgaXNBdWRpb0VuYWJsZWQ6IGJvb2xlYW47XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VMaXZlS2l0KHtcbiAgcm9vbU5hbWUsXG4gIHRva2VuLFxuICB1cmwsXG4gIGF1dG9TdWJzY3JpYmUgPSB0cnVlLFxufTogVXNlTGl2ZUtpdE9wdGlvbnMpOiBVc2VMaXZlS2l0UmVzdWx0IHtcbiAgY29uc3QgW3Jvb20sIHNldFJvb21dID0gdXNlU3RhdGU8Um9vbSB8IG51bGw+KG51bGwpO1xuICBjb25zdCBbbG9jYWxTdHJlYW0sIHNldExvY2FsU3RyZWFtXSA9IHVzZVN0YXRlPE1lZGlhU3RyZWFtIHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IFtyZW1vdGVTdHJlYW1zLCBzZXRSZW1vdGVTdHJlYW1zXSA9IHVzZVN0YXRlPE1hcDxzdHJpbmcsIE1lZGlhU3RyZWFtPj4obmV3IE1hcCgpKTtcbiAgY29uc3QgW3JlbW90ZVRyYWNrcywgc2V0UmVtb3RlVHJhY2tzXSA9IHVzZVN0YXRlPE1hcDxzdHJpbmcsIFJlbW90ZVBhcnRpY2lwYW50VHJhY2tzPj4obmV3IE1hcCgpKTtcbiAgY29uc3QgW2lzQ29ubmVjdGVkLCBzZXRJc0Nvbm5lY3RlZF0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IFtlcnJvciwgc2V0RXJyb3JdID0gdXNlU3RhdGU8c3RyaW5nIHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IFtpc1ZpZGVvRW5hYmxlZCwgc2V0SXNWaWRlb0VuYWJsZWRdID0gdXNlU3RhdGUodHJ1ZSk7XG4gIGNvbnN0IFtpc0F1ZGlvRW5hYmxlZCwgc2V0SXNBdWRpb0VuYWJsZWRdID0gdXNlU3RhdGUodHJ1ZSk7XG5cbiAgY29uc3Qgcm9vbVJlZiA9IHVzZVJlZjxSb29tIHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IGNvbm5lY3RQcm9taXNlUmVmID0gdXNlUmVmPFByb21pc2U8dm9pZD4gfCBudWxsPihudWxsKTtcbiAgY29uc3QgbGF0ZXN0T3B0aW9uc1JlZiA9IHVzZVJlZih7IHJvb21OYW1lLCB0b2tlbiwgdXJsIH0pO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgbGF0ZXN0T3B0aW9uc1JlZi5jdXJyZW50ID0geyByb29tTmFtZSwgdG9rZW4sIHVybCB9O1xuICB9LCBbcm9vbU5hbWUsIHRva2VuLCB1cmxdKTtcblxuICBjb25zdCBidWlsZE1lZGlhU3RyZWFtRnJvbUxvY2FsID0gdXNlQ2FsbGJhY2soKGN1cnJlbnRSb29tOiBSb29tKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHB1YmxpY2F0aW9ucyA9IEFycmF5LmZyb20oY3VycmVudFJvb20ubG9jYWxQYXJ0aWNpcGFudC50cmFja1B1YmxpY2F0aW9ucy52YWx1ZXMoKSk7XG4gICAgICBjb25zdCB0cmFja3M6IE1lZGlhU3RyZWFtVHJhY2tbXSA9IFtdO1xuICAgICAgcHVibGljYXRpb25zLmZvckVhY2goKHB1YikgPT4ge1xuICAgICAgICBjb25zdCBsa1RyYWNrID0gcHViLnRyYWNrO1xuICAgICAgICBpZiAoXG4gICAgICAgICAgbGtUcmFjayAmJlxuICAgICAgICAgIChsa1RyYWNrIGluc3RhbmNlb2YgTG9jYWxWaWRlb1RyYWNrIHx8IGxrVHJhY2sgaW5zdGFuY2VvZiBMb2NhbEF1ZGlvVHJhY2spXG4gICAgICAgICkge1xuICAgICAgICAgIGNvbnN0IG1lZGlhVHJhY2sgPSAobGtUcmFjayBhcyBhbnkpLm1lZGlhU3RyZWFtVHJhY2sgYXMgTWVkaWFTdHJlYW1UcmFjayB8IHVuZGVmaW5lZDtcbiAgICAgICAgICBpZiAobWVkaWFUcmFjaykge1xuICAgICAgICAgICAgdHJhY2tzLnB1c2gobWVkaWFUcmFjayk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGlmICh0cmFja3MubGVuZ3RoID4gMCkge1xuICAgICAgICBjb25zdCBzdHJlYW0gPSBuZXcgTWVkaWFTdHJlYW0odHJhY2tzKTtcbiAgICAgICAgc2V0TG9jYWxTdHJlYW0oc3RyZWFtKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGNvbnNvbGUud2FybignW0xpdmVLaXRdIEZhaWxlZCB0byBidWlsZCBsb2NhbCBzdHJlYW06JywgZXJyKTtcbiAgICB9XG4gIH0sIFtdKTtcblxuICBjb25zdCBhZGRSZW1vdGVUcmFjayA9IHVzZUNhbGxiYWNrKChwYXJ0aWNpcGFudElkOiBzdHJpbmcsIG1lZGlhVHJhY2s6IE1lZGlhU3RyZWFtVHJhY2spID0+IHtcbiAgICBzZXRSZW1vdGVTdHJlYW1zKChwcmV2KSA9PiB7XG4gICAgICBjb25zdCBuZXh0ID0gbmV3IE1hcChwcmV2KTtcbiAgICAgIGNvbnN0IGV4aXN0aW5nID0gbmV4dC5nZXQocGFydGljaXBhbnRJZCk7XG4gICAgICBcbiAgICAgIC8vIENyZWF0ZSBhIE5FVyBNZWRpYVN0cmVhbSB3aXRoIGFsbCBleGlzdGluZyB0cmFja3MgKyBuZXcgdHJhY2tcbiAgICAgIC8vIFRoaXMgZW5zdXJlcyBSZWFjdCBkZXRlY3RzIHRoZSBzdGF0ZSBjaGFuZ2VcbiAgICAgIGNvbnN0IGFsbFRyYWNrczogTWVkaWFTdHJlYW1UcmFja1tdID0gW107XG4gICAgICBpZiAoZXhpc3RpbmcpIHtcbiAgICAgICAgZXhpc3RpbmcuZ2V0VHJhY2tzKCkuZm9yRWFjaCh0ID0+IHtcbiAgICAgICAgICBpZiAodC5pZCAhPT0gbWVkaWFUcmFjay5pZCkge1xuICAgICAgICAgICAgYWxsVHJhY2tzLnB1c2godCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGFsbFRyYWNrcy5wdXNoKG1lZGlhVHJhY2spO1xuICAgICAgXG4gICAgICBjb25zdCBuZXdTdHJlYW0gPSBuZXcgTWVkaWFTdHJlYW0oYWxsVHJhY2tzKTtcbiAgICAgIG5leHQuc2V0KHBhcnRpY2lwYW50SWQsIG5ld1N0cmVhbSk7XG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKCdbTGl2ZUtpdF0gUmVtb3RlIHN0cmVhbXMgdXBkYXRlZDonLCB7XG4gICAgICAgIHBhcnRpY2lwYW50SWQsXG4gICAgICAgIG5ld1RyYWNrS2luZDogbWVkaWFUcmFjay5raW5kLFxuICAgICAgICB0b3RhbFRyYWNrczogbmV3U3RyZWFtLmdldFRyYWNrcygpLmxlbmd0aCxcbiAgICAgICAgbWFwU2l6ZTogbmV4dC5zaXplXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgcmV0dXJuIG5leHQ7XG4gICAgfSk7XG4gIH0sIFtdKTtcblxuICBjb25zdCByZW1vdmVSZW1vdGVUcmFjayA9IHVzZUNhbGxiYWNrKChwYXJ0aWNpcGFudElkOiBzdHJpbmcsIG1lZGlhVHJhY2s/OiBNZWRpYVN0cmVhbVRyYWNrKSA9PiB7XG4gICAgc2V0UmVtb3RlU3RyZWFtcygocHJldikgPT4ge1xuICAgICAgY29uc3QgbmV4dCA9IG5ldyBNYXAocHJldik7XG4gICAgICBjb25zdCBleGlzdGluZyA9IG5leHQuZ2V0KHBhcnRpY2lwYW50SWQpO1xuICAgICAgaWYgKCFleGlzdGluZykgcmV0dXJuIHByZXY7XG4gICAgICBpZiAobWVkaWFUcmFjaykge1xuICAgICAgICBleGlzdGluZy5yZW1vdmVUcmFjayhtZWRpYVRyYWNrKTtcbiAgICAgIH1cbiAgICAgIGlmIChleGlzdGluZy5nZXRUcmFja3MoKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgbmV4dC5kZWxldGUocGFydGljaXBhbnRJZCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBuZXh0LnNldChwYXJ0aWNpcGFudElkLCBleGlzdGluZyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gbmV4dDtcbiAgICB9KTtcbiAgfSwgW10pO1xuXG4gIGNvbnN0IGRpc2Nvbm5lY3QgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgaWYgKHJvb21SZWYuY3VycmVudCkge1xuICAgICAgcm9vbVJlZi5jdXJyZW50LmRpc2Nvbm5lY3QoKTtcbiAgICAgIHJvb21SZWYuY3VycmVudCA9IG51bGw7XG4gICAgfVxuICAgIGNvbm5lY3RQcm9taXNlUmVmLmN1cnJlbnQgPSBudWxsO1xuICAgIHNldFJvb20obnVsbCk7XG4gICAgc2V0SXNDb25uZWN0ZWQoZmFsc2UpO1xuICAgIHNldExvY2FsU3RyZWFtKG51bGwpO1xuICAgIHNldFJlbW90ZVN0cmVhbXMobmV3IE1hcCgpKTtcbiAgICBzZXRFcnJvcihudWxsKTtcbiAgfSwgW10pO1xuXG4gIGNvbnN0IGNvbm5lY3QgPSB1c2VDYWxsYmFjayhhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgeyByb29tTmFtZTogY3VycmVudFJvb21OYW1lLCB0b2tlbjogY3VycmVudFRva2VuLCB1cmw6IGN1cnJlbnRVcmwgfSA9XG4gICAgICBsYXRlc3RPcHRpb25zUmVmLmN1cnJlbnQ7XG5cbiAgICBpZiAoIWN1cnJlbnRSb29tTmFtZSB8fCAhY3VycmVudFRva2VuIHx8ICFjdXJyZW50VXJsKSB7XG4gICAgICBzZXRFcnJvcignVGhp4bq/dSB0aMO0bmcgdGluIExpdmVLaXQgKHJvb20vdG9rZW4vdXJsKScpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChyb29tUmVmLmN1cnJlbnQgJiYgcm9vbVJlZi5jdXJyZW50LnN0YXRlID09PSAnY29ubmVjdGVkJykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChjb25uZWN0UHJvbWlzZVJlZi5jdXJyZW50KSB7XG4gICAgICByZXR1cm4gY29ubmVjdFByb21pc2VSZWYuY3VycmVudDtcbiAgICB9XG5cbiAgICBjb25zdCBwcm9taXNlID0gKGFzeW5jICgpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHNldEVycm9yKG51bGwpO1xuICAgICAgICBjb25zdCBuZXdSb29tID0gbmV3IFJvb20oe1xuICAgICAgICAgIGFkYXB0aXZlU3RyZWFtOiB0cnVlLFxuICAgICAgICAgIGR5bmFjYXN0OiB0cnVlLFxuICAgICAgICB9KTtcblxuICAgICAgICByb29tUmVmLmN1cnJlbnQgPSBuZXdSb29tO1xuICAgICAgICBzZXRSb29tKG5ld1Jvb20pO1xuXG4gICAgICAgIG5ld1Jvb20ub24oUm9vbUV2ZW50LkNvbm5lY3RlZCwgKCkgPT4ge1xuICAgICAgICAgIHNldElzQ29ubmVjdGVkKHRydWUpO1xuICAgICAgICB9KTtcblxuICAgICAgICBuZXdSb29tLm9uKFJvb21FdmVudC5EaXNjb25uZWN0ZWQsICgpID0+IHtcbiAgICAgICAgICBzZXRJc0Nvbm5lY3RlZChmYWxzZSk7XG4gICAgICAgICAgc2V0TG9jYWxTdHJlYW0obnVsbCk7XG4gICAgICAgICAgc2V0UmVtb3RlU3RyZWFtcyhuZXcgTWFwKCkpO1xuICAgICAgICB9KTtcblxuICAgICAgICBuZXdSb29tLm9uKFJvb21FdmVudC5UcmFja1N1YnNjcmliZWQsICh0cmFjaywgcHVibGljYXRpb24sIHBhcnRpY2lwYW50KSA9PiB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ1tMaXZlS2l0XSBUcmFja1N1YnNjcmliZWQ6Jywge1xuICAgICAgICAgICAgdHJhY2tLaW5kOiB0cmFjay5raW5kLFxuICAgICAgICAgICAgcGFydGljaXBhbnRJZDogcGFydGljaXBhbnQuaWRlbnRpdHksXG4gICAgICAgICAgICBwYXJ0aWNpcGFudFNpZDogcGFydGljaXBhbnQuc2lkLFxuICAgICAgICAgICAgdHJhY2tTaWQ6IHRyYWNrLnNpZCxcbiAgICAgICAgICAgIGlzTXV0ZWQ6IHB1YmxpY2F0aW9uLmlzTXV0ZWQsXG4gICAgICAgICAgICBpc1N1YnNjcmliZWQ6IHB1YmxpY2F0aW9uLmlzU3Vic2NyaWJlZFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGlmICh0cmFjayBpbnN0YW5jZW9mIFJlbW90ZVRyYWNrKSB7XG4gICAgICAgICAgICAvLyBTdG9yZSB0aGUgUmVtb3RlVHJhY2sgZm9yIGRpcmVjdCBhdHRhY2htZW50IGluIGNvbXBvbmVudHNcbiAgICAgICAgICAgIHNldFJlbW90ZVRyYWNrcygocHJldikgPT4ge1xuICAgICAgICAgICAgICBjb25zdCBuZXh0ID0gbmV3IE1hcChwcmV2KTtcbiAgICAgICAgICAgICAgY29uc3QgZXhpc3RpbmcgPSBuZXh0LmdldChwYXJ0aWNpcGFudC5pZGVudGl0eSkgfHwge307XG4gICAgICAgICAgICAgIGlmICh0cmFjay5raW5kID09PSAndmlkZW8nKSB7XG4gICAgICAgICAgICAgICAgbmV4dC5zZXQocGFydGljaXBhbnQuaWRlbnRpdHksIHsgLi4uZXhpc3RpbmcsIHZpZGVvVHJhY2s6IHRyYWNrIH0pO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRyYWNrLmtpbmQgPT09ICdhdWRpbycpIHtcbiAgICAgICAgICAgICAgICBuZXh0LnNldChwYXJ0aWNpcGFudC5pZGVudGl0eSwgeyAuLi5leGlzdGluZywgYXVkaW9UcmFjazogdHJhY2sgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1tMaXZlS2l0XSBVcGRhdGVkIHJlbW90ZVRyYWNrczonLCB7XG4gICAgICAgICAgICAgICAgcGFydGljaXBhbnRJZDogcGFydGljaXBhbnQuaWRlbnRpdHksXG4gICAgICAgICAgICAgICAgdHJhY2tLaW5kOiB0cmFjay5raW5kLFxuICAgICAgICAgICAgICAgIHRvdGFsUGFydGljaXBhbnRzOiBuZXh0LnNpemVcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIHJldHVybiBuZXh0O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEFsc28gYWRkIHRvIHJlbW90ZVN0cmVhbXMgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcbiAgICAgICAgICAgIGNvbnN0IG1lZGlhVHJhY2sgPSAodHJhY2sgYXMgYW55KS5tZWRpYVN0cmVhbVRyYWNrIGFzIE1lZGlhU3RyZWFtVHJhY2sgfCB1bmRlZmluZWQ7XG4gICAgICAgICAgICBpZiAobWVkaWFUcmFjaykge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZygnW0xpdmVLaXRdIEFkZGluZyByZW1vdGUgTWVkaWFTdHJlYW1UcmFjazonLCB7XG4gICAgICAgICAgICAgICAgcGFydGljaXBhbnRJZDogcGFydGljaXBhbnQuaWRlbnRpdHksXG4gICAgICAgICAgICAgICAgdHJhY2tJZDogbWVkaWFUcmFjay5pZCxcbiAgICAgICAgICAgICAgICB0cmFja0tpbmQ6IG1lZGlhVHJhY2sua2luZCxcbiAgICAgICAgICAgICAgICB0cmFja0VuYWJsZWQ6IG1lZGlhVHJhY2suZW5hYmxlZCxcbiAgICAgICAgICAgICAgICB0cmFja011dGVkOiBtZWRpYVRyYWNrLm11dGVkXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBhZGRSZW1vdGVUcmFjayhwYXJ0aWNpcGFudC5pZGVudGl0eSwgbWVkaWFUcmFjayk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIEhhbmRsZSB0cmFjayBtdXRlZC91bm11dGVkIGV2ZW50cyBmcm9tIHJlbW90ZSBwYXJ0aWNpcGFudHNcbiAgICAgICAgbmV3Um9vbS5vbihSb29tRXZlbnQuVHJhY2tNdXRlZCwgKHB1YmxpY2F0aW9uLCBwYXJ0aWNpcGFudCkgPT4ge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdbTGl2ZUtpdF0gVHJhY2tNdXRlZDonLCB7XG4gICAgICAgICAgICB0cmFja0tpbmQ6IHB1YmxpY2F0aW9uLmtpbmQsXG4gICAgICAgICAgICBwYXJ0aWNpcGFudElkOiBwYXJ0aWNpcGFudC5pZGVudGl0eSxcbiAgICAgICAgICAgIHNvdXJjZTogcHVibGljYXRpb24uc291cmNlXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgbmV3Um9vbS5vbihSb29tRXZlbnQuVHJhY2tVbm11dGVkLCAocHVibGljYXRpb24sIHBhcnRpY2lwYW50KSA9PiB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ1tMaXZlS2l0XSBUcmFja1VubXV0ZWQ6Jywge1xuICAgICAgICAgICAgdHJhY2tLaW5kOiBwdWJsaWNhdGlvbi5raW5kLFxuICAgICAgICAgICAgcGFydGljaXBhbnRJZDogcGFydGljaXBhbnQuaWRlbnRpdHksXG4gICAgICAgICAgICBzb3VyY2U6IHB1YmxpY2F0aW9uLnNvdXJjZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIC8vIFJlLWFkZCB0cmFjayB3aGVuIHVubXV0ZWRcbiAgICAgICAgICBpZiAocHVibGljYXRpb24udHJhY2sgaW5zdGFuY2VvZiBSZW1vdGVUcmFjaykge1xuICAgICAgICAgICAgY29uc3QgbWVkaWFUcmFjayA9IChwdWJsaWNhdGlvbi50cmFjayBhcyBhbnkpLm1lZGlhU3RyZWFtVHJhY2sgYXMgTWVkaWFTdHJlYW1UcmFjayB8IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIGlmIChtZWRpYVRyYWNrKSB7XG4gICAgICAgICAgICAgIGFkZFJlbW90ZVRyYWNrKHBhcnRpY2lwYW50LmlkZW50aXR5LCBtZWRpYVRyYWNrKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgbmV3Um9vbS5vbihSb29tRXZlbnQuUGFydGljaXBhbnRDb25uZWN0ZWQsIChwYXJ0aWNpcGFudCkgPT4ge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdbTGl2ZUtpdF0gUGFydGljaXBhbnRDb25uZWN0ZWQ6Jywge1xuICAgICAgICAgICAgcGFydGljaXBhbnRJZDogcGFydGljaXBhbnQuaWRlbnRpdHksXG4gICAgICAgICAgICBwYXJ0aWNpcGFudFNpZDogcGFydGljaXBhbnQuc2lkLFxuICAgICAgICAgICAgdHJhY2tDb3VudDogcGFydGljaXBhbnQudHJhY2tQdWJsaWNhdGlvbnMuc2l6ZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBuZXdSb29tLm9uKFJvb21FdmVudC5UcmFja1Vuc3Vic2NyaWJlZCwgKHRyYWNrLCBwdWJsaWNhdGlvbiwgcGFydGljaXBhbnQpID0+IHtcbiAgICAgICAgICBpZiAodHJhY2sgaW5zdGFuY2VvZiBSZW1vdGVUcmFjaykge1xuICAgICAgICAgICAgY29uc3QgbWVkaWFUcmFjayA9ICh0cmFjayBhcyBhbnkpLm1lZGlhU3RyZWFtVHJhY2sgYXMgTWVkaWFTdHJlYW1UcmFjayB8IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHJlbW92ZVJlbW90ZVRyYWNrKHBhcnRpY2lwYW50LmlkZW50aXR5LCBtZWRpYVRyYWNrKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIG5ld1Jvb20ub24oUm9vbUV2ZW50LlBhcnRpY2lwYW50RGlzY29ubmVjdGVkLCAocGFydGljaXBhbnQpID0+IHtcbiAgICAgICAgICBzZXRSZW1vdGVTdHJlYW1zKChwcmV2KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuZXh0ID0gbmV3IE1hcChwcmV2KTtcbiAgICAgICAgICAgIG5leHQuZGVsZXRlKHBhcnRpY2lwYW50LmlkZW50aXR5KTtcbiAgICAgICAgICAgIHJldHVybiBuZXh0O1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBjb25zb2xlLmxvZygnW0xpdmVLaXRdIENvbm5lY3RpbmcgdG8gcm9vbTonLCBjdXJyZW50Um9vbU5hbWUsICdhdCBVUkw6JywgY3VycmVudFVybCk7XG4gICAgICAgIGF3YWl0IG5ld1Jvb20uY29ubmVjdChjdXJyZW50VXJsLCBjdXJyZW50VG9rZW4pO1xuICAgICAgICBjb25zb2xlLmxvZygnW0xpdmVLaXRdIENvbm5lY3RlZCEgUm9vbSBzdGF0ZTonLCBuZXdSb29tLnN0YXRlKTtcbiAgICAgICAgY29uc29sZS5sb2coJ1tMaXZlS2l0XSBSZW1vdGUgcGFydGljaXBhbnRzOicsIG5ld1Jvb20ucmVtb3RlUGFydGljaXBhbnRzLnNpemUpO1xuICAgICAgICBcbiAgICAgICAgLy8gTG9nIGV4aXN0aW5nIHJlbW90ZSBwYXJ0aWNpcGFudHNcbiAgICAgICAgbmV3Um9vbS5yZW1vdGVQYXJ0aWNpcGFudHMuZm9yRWFjaCgocGFydGljaXBhbnQsIHNpZCkgPT4ge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdbTGl2ZUtpdF0gRXhpc3RpbmcgcmVtb3RlIHBhcnRpY2lwYW50OicsIHtcbiAgICAgICAgICAgIGlkZW50aXR5OiBwYXJ0aWNpcGFudC5pZGVudGl0eSxcbiAgICAgICAgICAgIHNpZDogc2lkLFxuICAgICAgICAgICAgdHJhY2tDb3VudDogcGFydGljaXBhbnQudHJhY2tQdWJsaWNhdGlvbnMuc2l6ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIC8vIFN1YnNjcmliZSB0byBhbnkgZXhpc3RpbmcgdHJhY2tzXG4gICAgICAgICAgcGFydGljaXBhbnQudHJhY2tQdWJsaWNhdGlvbnMuZm9yRWFjaCgocHViKSA9PiB7XG4gICAgICAgICAgICBpZiAocHViLnRyYWNrICYmIHB1Yi50cmFjayBpbnN0YW5jZW9mIFJlbW90ZVRyYWNrKSB7XG4gICAgICAgICAgICAgIGNvbnN0IG1lZGlhVHJhY2sgPSAocHViLnRyYWNrIGFzIGFueSkubWVkaWFTdHJlYW1UcmFjayBhcyBNZWRpYVN0cmVhbVRyYWNrIHwgdW5kZWZpbmVkO1xuICAgICAgICAgICAgICBpZiAobWVkaWFUcmFjaykge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbTGl2ZUtpdF0gRm91bmQgZXhpc3RpbmcgcmVtb3RlIHRyYWNrOicsIHtcbiAgICAgICAgICAgICAgICAgIHBhcnRpY2lwYW50SWQ6IHBhcnRpY2lwYW50LmlkZW50aXR5LFxuICAgICAgICAgICAgICAgICAgdHJhY2tJZDogbWVkaWFUcmFjay5pZCxcbiAgICAgICAgICAgICAgICAgIHRyYWNrS2luZDogbWVkaWFUcmFjay5raW5kXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgYWRkUmVtb3RlVHJhY2socGFydGljaXBhbnQuaWRlbnRpdHksIG1lZGlhVHJhY2spO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgYXdhaXQgbmV3Um9vbS5sb2NhbFBhcnRpY2lwYW50LmVuYWJsZUNhbWVyYUFuZE1pY3JvcGhvbmUoKTtcbiAgICAgICAgY29uc29sZS5sb2coJ1tMaXZlS2l0XSBDYW1lcmEgYW5kIG1pY3JvcGhvbmUgZW5hYmxlZCcpO1xuICAgICAgICBidWlsZE1lZGlhU3RyZWFtRnJvbUxvY2FsKG5ld1Jvb20pO1xuICAgICAgfSBjYXRjaCAoZXJyOiBhbnkpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignW0xpdmVLaXRdIEVycm9yIGNvbm5lY3Rpbmc6JywgZXJyKTtcbiAgICAgICAgc2V0RXJyb3IoZXJyPy5tZXNzYWdlIHx8ICdLaMO0bmcgdGjhu4Mga+G6v3QgbuG7kWkgTGl2ZUtpdCcpO1xuICAgICAgICBkaXNjb25uZWN0KCk7XG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICBjb25uZWN0UHJvbWlzZVJlZi5jdXJyZW50ID0gbnVsbDtcbiAgICAgIH1cbiAgICB9KSgpO1xuXG4gICAgY29ubmVjdFByb21pc2VSZWYuY3VycmVudCA9IHByb21pc2U7XG4gICAgcmV0dXJuIHByb21pc2U7XG4gIH0sIFthZGRSZW1vdGVUcmFjaywgYXV0b1N1YnNjcmliZSwgYnVpbGRNZWRpYVN0cmVhbUZyb21Mb2NhbCwgZGlzY29ubmVjdCwgcmVtb3ZlUmVtb3RlVHJhY2tdKTtcblxuICBjb25zdCB0b2dnbGVWaWRlbyA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICBpZiAoIXJvb21SZWYuY3VycmVudCkgcmV0dXJuO1xuICAgIGNvbnN0IGVuYWJsZWQgPSAhaXNWaWRlb0VuYWJsZWQ7XG4gICAgcm9vbVJlZi5jdXJyZW50LmxvY2FsUGFydGljaXBhbnQuc2V0Q2FtZXJhRW5hYmxlZChlbmFibGVkKTtcbiAgICBzZXRJc1ZpZGVvRW5hYmxlZChlbmFibGVkKTtcbiAgfSwgW2lzVmlkZW9FbmFibGVkXSk7XG5cbiAgY29uc3QgdG9nZ2xlQXVkaW8gPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgaWYgKCFyb29tUmVmLmN1cnJlbnQpIHJldHVybjtcbiAgICBjb25zdCBlbmFibGVkID0gIWlzQXVkaW9FbmFibGVkO1xuICAgIHJvb21SZWYuY3VycmVudC5sb2NhbFBhcnRpY2lwYW50LnNldE1pY3JvcGhvbmVFbmFibGVkKGVuYWJsZWQpO1xuICAgIHNldElzQXVkaW9FbmFibGVkKGVuYWJsZWQpO1xuICB9LCBbaXNBdWRpb0VuYWJsZWRdKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBkaXNjb25uZWN0KCk7XG4gICAgfTtcbiAgfSwgW2Rpc2Nvbm5lY3RdKTtcblxuICByZXR1cm4ge1xuICAgIHJvb20sXG4gICAgbG9jYWxTdHJlYW0sXG4gICAgcmVtb3RlU3RyZWFtcyxcbiAgICBpc0Nvbm5lY3RlZCxcbiAgICBlcnJvcixcbiAgICBjb25uZWN0LFxuICAgIGRpc2Nvbm5lY3QsXG4gICAgdG9nZ2xlVmlkZW8sXG4gICAgdG9nZ2xlQXVkaW8sXG4gICAgaXNWaWRlb0VuYWJsZWQsXG4gICAgaXNBdWRpb0VuYWJsZWQsXG4gIH07XG59XG5cbiJdLCJuYW1lcyI6WyJ1c2VDYWxsYmFjayIsInVzZUVmZmVjdCIsInVzZVJlZiIsInVzZVN0YXRlIiwiUm9vbSIsIlJvb21FdmVudCIsIlJlbW90ZVRyYWNrIiwiTG9jYWxWaWRlb1RyYWNrIiwiTG9jYWxBdWRpb1RyYWNrIiwidXNlTGl2ZUtpdCIsInJvb21OYW1lIiwidG9rZW4iLCJ1cmwiLCJhdXRvU3Vic2NyaWJlIiwicm9vbSIsInNldFJvb20iLCJsb2NhbFN0cmVhbSIsInNldExvY2FsU3RyZWFtIiwicmVtb3RlU3RyZWFtcyIsInNldFJlbW90ZVN0cmVhbXMiLCJNYXAiLCJyZW1vdGVUcmFja3MiLCJzZXRSZW1vdGVUcmFja3MiLCJpc0Nvbm5lY3RlZCIsInNldElzQ29ubmVjdGVkIiwiZXJyb3IiLCJzZXRFcnJvciIsImlzVmlkZW9FbmFibGVkIiwic2V0SXNWaWRlb0VuYWJsZWQiLCJpc0F1ZGlvRW5hYmxlZCIsInNldElzQXVkaW9FbmFibGVkIiwicm9vbVJlZiIsImNvbm5lY3RQcm9taXNlUmVmIiwibGF0ZXN0T3B0aW9uc1JlZiIsImN1cnJlbnQiLCJidWlsZE1lZGlhU3RyZWFtRnJvbUxvY2FsIiwiY3VycmVudFJvb20iLCJwdWJsaWNhdGlvbnMiLCJBcnJheSIsImZyb20iLCJsb2NhbFBhcnRpY2lwYW50IiwidHJhY2tQdWJsaWNhdGlvbnMiLCJ2YWx1ZXMiLCJ0cmFja3MiLCJmb3JFYWNoIiwicHViIiwibGtUcmFjayIsInRyYWNrIiwibWVkaWFUcmFjayIsIm1lZGlhU3RyZWFtVHJhY2siLCJwdXNoIiwibGVuZ3RoIiwic3RyZWFtIiwiTWVkaWFTdHJlYW0iLCJlcnIiLCJjb25zb2xlIiwid2FybiIsImFkZFJlbW90ZVRyYWNrIiwicGFydGljaXBhbnRJZCIsInByZXYiLCJuZXh0IiwiZXhpc3RpbmciLCJnZXQiLCJhbGxUcmFja3MiLCJnZXRUcmFja3MiLCJ0IiwiaWQiLCJuZXdTdHJlYW0iLCJzZXQiLCJsb2ciLCJuZXdUcmFja0tpbmQiLCJraW5kIiwidG90YWxUcmFja3MiLCJtYXBTaXplIiwic2l6ZSIsInJlbW92ZVJlbW90ZVRyYWNrIiwicmVtb3ZlVHJhY2siLCJkZWxldGUiLCJkaXNjb25uZWN0IiwiY29ubmVjdCIsImN1cnJlbnRSb29tTmFtZSIsImN1cnJlbnRUb2tlbiIsImN1cnJlbnRVcmwiLCJzdGF0ZSIsInByb21pc2UiLCJuZXdSb29tIiwiYWRhcHRpdmVTdHJlYW0iLCJkeW5hY2FzdCIsIm9uIiwiQ29ubmVjdGVkIiwiRGlzY29ubmVjdGVkIiwiVHJhY2tTdWJzY3JpYmVkIiwicHVibGljYXRpb24iLCJwYXJ0aWNpcGFudCIsInRyYWNrS2luZCIsImlkZW50aXR5IiwicGFydGljaXBhbnRTaWQiLCJzaWQiLCJ0cmFja1NpZCIsImlzTXV0ZWQiLCJpc1N1YnNjcmliZWQiLCJ2aWRlb1RyYWNrIiwiYXVkaW9UcmFjayIsInRvdGFsUGFydGljaXBhbnRzIiwidHJhY2tJZCIsInRyYWNrRW5hYmxlZCIsImVuYWJsZWQiLCJ0cmFja011dGVkIiwibXV0ZWQiLCJUcmFja011dGVkIiwic291cmNlIiwiVHJhY2tVbm11dGVkIiwiUGFydGljaXBhbnRDb25uZWN0ZWQiLCJ0cmFja0NvdW50IiwiVHJhY2tVbnN1YnNjcmliZWQiLCJQYXJ0aWNpcGFudERpc2Nvbm5lY3RlZCIsInJlbW90ZVBhcnRpY2lwYW50cyIsImVuYWJsZUNhbWVyYUFuZE1pY3JvcGhvbmUiLCJtZXNzYWdlIiwidG9nZ2xlVmlkZW8iLCJzZXRDYW1lcmFFbmFibGVkIiwidG9nZ2xlQXVkaW8iLCJzZXRNaWNyb3Bob25lRW5hYmxlZCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/../../packages/app/hooks/useLiveKit.ts\n"));

/***/ })

});