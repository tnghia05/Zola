"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/call/page",{

/***/ "(app-pages-browser)/../../packages/app/hooks/useLiveKit.ts":
/*!**********************************************!*\
  !*** ../../packages/app/hooks/useLiveKit.ts ***!
  \**********************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   useLiveKit: function() { return /* binding */ useLiveKit; }\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"(app-pages-browser)/../../node_modules/.pnpm/next@14.0.4_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/next/dist/compiled/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var livekit_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! livekit-client */ \"(app-pages-browser)/../../node_modules/.pnpm/livekit-client@2.16.0_@types+dom-mediacapture-record@1.0.22/node_modules/livekit-client/dist/livekit-client.esm.mjs\");\n\n\nfunction useLiveKit(param) {\n    let { roomName, token, url, autoSubscribe = true } = param;\n    const [room, setRoom] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null);\n    const [localStream, setLocalStream] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null);\n    const [remoteStreams, setRemoteStreams] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(new Map());\n    const [remoteTracks, setRemoteTracks] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(new Map());\n    const [isConnected, setIsConnected] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);\n    const [error, setError] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null);\n    const [isVideoEnabled, setIsVideoEnabled] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(true);\n    const [isAudioEnabled, setIsAudioEnabled] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(true);\n    const roomRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);\n    const connectPromiseRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);\n    const latestOptionsRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)({\n        roomName,\n        token,\n        url\n    });\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{\n        latestOptionsRef.current = {\n            roomName,\n            token,\n            url\n        };\n    }, [\n        roomName,\n        token,\n        url\n    ]);\n    const buildMediaStreamFromLocal = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((currentRoom)=>{\n        try {\n            const publications = Array.from(currentRoom.localParticipant.trackPublications.values());\n            const tracks = [];\n            publications.forEach((pub)=>{\n                const lkTrack = pub.track;\n                if (lkTrack && (lkTrack instanceof livekit_client__WEBPACK_IMPORTED_MODULE_1__.LocalVideoTrack || lkTrack instanceof livekit_client__WEBPACK_IMPORTED_MODULE_1__.LocalAudioTrack)) {\n                    const mediaTrack = lkTrack.mediaStreamTrack;\n                    if (mediaTrack) {\n                        tracks.push(mediaTrack);\n                    }\n                }\n            });\n            if (tracks.length > 0) {\n                const stream = new MediaStream(tracks);\n                setLocalStream(stream);\n            }\n        } catch (err) {\n            console.warn(\"[LiveKit] Failed to build local stream:\", err);\n        }\n    }, []);\n    const addRemoteTrack = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((participantId, mediaTrack)=>{\n        setRemoteStreams((prev)=>{\n            const next = new Map(prev);\n            const existing = next.get(participantId);\n            // Create a NEW MediaStream with all existing tracks + new track\n            // This ensures React detects the state change\n            const allTracks = [];\n            if (existing) {\n                existing.getTracks().forEach((t)=>{\n                    if (t.id !== mediaTrack.id) {\n                        allTracks.push(t);\n                    }\n                });\n            }\n            allTracks.push(mediaTrack);\n            const newStream = new MediaStream(allTracks);\n            next.set(participantId, newStream);\n            console.log(\"[LiveKit] Remote streams updated:\", {\n                participantId,\n                newTrackKind: mediaTrack.kind,\n                totalTracks: newStream.getTracks().length,\n                mapSize: next.size\n            });\n            return next;\n        });\n    }, []);\n    const removeRemoteTrack = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((participantId, mediaTrack)=>{\n        setRemoteStreams((prev)=>{\n            const next = new Map(prev);\n            const existing = next.get(participantId);\n            if (!existing) return prev;\n            if (mediaTrack) {\n                existing.removeTrack(mediaTrack);\n            }\n            if (existing.getTracks().length === 0) {\n                next.delete(participantId);\n            } else {\n                next.set(participantId, existing);\n            }\n            return next;\n        });\n    }, []);\n    const disconnect = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(()=>{\n        if (roomRef.current) {\n            roomRef.current.disconnect();\n            roomRef.current = null;\n        }\n        connectPromiseRef.current = null;\n        setRoom(null);\n        setIsConnected(false);\n        setLocalStream(null);\n        setRemoteStreams(new Map());\n        setError(null);\n    }, []);\n    const connect = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(async ()=>{\n        const { roomName: currentRoomName, token: currentToken, url: currentUrl } = latestOptionsRef.current;\n        if (!currentRoomName || !currentToken || !currentUrl) {\n            setError(\"Thiếu th\\xf4ng tin LiveKit (room/token/url)\");\n            return;\n        }\n        if (roomRef.current && roomRef.current.state === \"connected\") {\n            return;\n        }\n        if (connectPromiseRef.current) {\n            return connectPromiseRef.current;\n        }\n        const promise = (async ()=>{\n            try {\n                setError(null);\n                const newRoom = new livekit_client__WEBPACK_IMPORTED_MODULE_1__.Room({\n                    adaptiveStream: true,\n                    dynacast: true\n                });\n                roomRef.current = newRoom;\n                setRoom(newRoom);\n                newRoom.on(livekit_client__WEBPACK_IMPORTED_MODULE_1__.RoomEvent.Connected, ()=>{\n                    setIsConnected(true);\n                });\n                newRoom.on(livekit_client__WEBPACK_IMPORTED_MODULE_1__.RoomEvent.Disconnected, ()=>{\n                    setIsConnected(false);\n                    setLocalStream(null);\n                    setRemoteStreams(new Map());\n                });\n                newRoom.on(livekit_client__WEBPACK_IMPORTED_MODULE_1__.RoomEvent.TrackSubscribed, (track, publication, participant)=>{\n                    console.log(\"[LiveKit] TrackSubscribed:\", {\n                        trackKind: track.kind,\n                        participantId: participant.identity,\n                        participantSid: participant.sid,\n                        trackSid: track.sid,\n                        isMuted: publication.isMuted,\n                        isSubscribed: publication.isSubscribed\n                    });\n                    if (track instanceof livekit_client__WEBPACK_IMPORTED_MODULE_1__.RemoteTrack) {\n                        // Use LiveKit's attach method to get a properly initialized video element\n                        // Then extract the stream from it\n                        const tempElement = track.attach();\n                        const mediaStream = tempElement.srcObject;\n                        if (mediaStream) {\n                            const videoTrack = mediaStream.getVideoTracks()[0];\n                            const audioTrack = mediaStream.getAudioTracks()[0];\n                            console.log(\"[LiveKit] Got MediaStream from attached element:\", {\n                                participantId: participant.identity,\n                                trackKind: track.kind,\n                                streamId: mediaStream.id,\n                                videoTracks: mediaStream.getVideoTracks().length,\n                                audioTracks: mediaStream.getAudioTracks().length,\n                                videoMuted: videoTrack === null || videoTrack === void 0 ? void 0 : videoTrack.muted,\n                                audioMuted: audioTrack === null || audioTrack === void 0 ? void 0 : audioTrack.muted\n                            });\n                            // Add all tracks from the attached stream\n                            mediaStream.getTracks().forEach((mediaTrack)=>{\n                                console.log(\"[LiveKit] Adding attached track:\", {\n                                    participantId: participant.identity,\n                                    trackKind: mediaTrack.kind,\n                                    trackEnabled: mediaTrack.enabled,\n                                    trackMuted: mediaTrack.muted\n                                });\n                                addRemoteTrack(participant.identity, mediaTrack);\n                            });\n                            // Detach the temp element since we only needed the stream\n                            track.detach(tempElement);\n                        } else {\n                            // Fallback to old method\n                            const mediaTrack = track.mediaStreamTrack;\n                            if (mediaTrack) {\n                                console.log(\"[LiveKit] Fallback: Adding remote track directly:\", {\n                                    participantId: participant.identity,\n                                    trackId: mediaTrack.id,\n                                    trackKind: mediaTrack.kind\n                                });\n                                addRemoteTrack(participant.identity, mediaTrack);\n                            }\n                        }\n                    }\n                });\n                // Handle track muted/unmuted events from remote participants\n                newRoom.on(livekit_client__WEBPACK_IMPORTED_MODULE_1__.RoomEvent.TrackMuted, (publication, participant)=>{\n                    console.log(\"[LiveKit] TrackMuted:\", {\n                        trackKind: publication.kind,\n                        participantId: participant.identity,\n                        source: publication.source\n                    });\n                });\n                newRoom.on(livekit_client__WEBPACK_IMPORTED_MODULE_1__.RoomEvent.TrackUnmuted, (publication, participant)=>{\n                    console.log(\"[LiveKit] TrackUnmuted:\", {\n                        trackKind: publication.kind,\n                        participantId: participant.identity,\n                        source: publication.source\n                    });\n                    // Re-add track when unmuted\n                    if (publication.track instanceof livekit_client__WEBPACK_IMPORTED_MODULE_1__.RemoteTrack) {\n                        const mediaTrack = publication.track.mediaStreamTrack;\n                        if (mediaTrack) {\n                            addRemoteTrack(participant.identity, mediaTrack);\n                        }\n                    }\n                });\n                newRoom.on(livekit_client__WEBPACK_IMPORTED_MODULE_1__.RoomEvent.ParticipantConnected, (participant)=>{\n                    console.log(\"[LiveKit] ParticipantConnected:\", {\n                        participantId: participant.identity,\n                        participantSid: participant.sid,\n                        trackCount: participant.trackPublications.size\n                    });\n                });\n                newRoom.on(livekit_client__WEBPACK_IMPORTED_MODULE_1__.RoomEvent.TrackUnsubscribed, (track, publication, participant)=>{\n                    if (track instanceof livekit_client__WEBPACK_IMPORTED_MODULE_1__.RemoteTrack) {\n                        const mediaTrack = track.mediaStreamTrack;\n                        removeRemoteTrack(participant.identity, mediaTrack);\n                    }\n                });\n                newRoom.on(livekit_client__WEBPACK_IMPORTED_MODULE_1__.RoomEvent.ParticipantDisconnected, (participant)=>{\n                    setRemoteStreams((prev)=>{\n                        const next = new Map(prev);\n                        next.delete(participant.identity);\n                        return next;\n                    });\n                });\n                console.log(\"[LiveKit] Connecting to room:\", currentRoomName, \"at URL:\", currentUrl);\n                await newRoom.connect(currentUrl, currentToken);\n                console.log(\"[LiveKit] Connected! Room state:\", newRoom.state);\n                console.log(\"[LiveKit] Remote participants:\", newRoom.remoteParticipants.size);\n                // Log existing remote participants\n                newRoom.remoteParticipants.forEach((participant, sid)=>{\n                    console.log(\"[LiveKit] Existing remote participant:\", {\n                        identity: participant.identity,\n                        sid: sid,\n                        trackCount: participant.trackPublications.size\n                    });\n                    // Subscribe to any existing tracks\n                    participant.trackPublications.forEach((pub)=>{\n                        if (pub.track && pub.track instanceof livekit_client__WEBPACK_IMPORTED_MODULE_1__.RemoteTrack) {\n                            const mediaTrack = pub.track.mediaStreamTrack;\n                            if (mediaTrack) {\n                                console.log(\"[LiveKit] Found existing remote track:\", {\n                                    participantId: participant.identity,\n                                    trackId: mediaTrack.id,\n                                    trackKind: mediaTrack.kind\n                                });\n                                addRemoteTrack(participant.identity, mediaTrack);\n                            }\n                        }\n                    });\n                });\n                await newRoom.localParticipant.enableCameraAndMicrophone();\n                console.log(\"[LiveKit] Camera and microphone enabled\");\n                buildMediaStreamFromLocal(newRoom);\n            } catch (err) {\n                console.error(\"[LiveKit] Error connecting:\", err);\n                setError((err === null || err === void 0 ? void 0 : err.message) || \"Kh\\xf4ng thể kết nối LiveKit\");\n                disconnect();\n            } finally{\n                connectPromiseRef.current = null;\n            }\n        })();\n        connectPromiseRef.current = promise;\n        return promise;\n    }, [\n        addRemoteTrack,\n        autoSubscribe,\n        buildMediaStreamFromLocal,\n        disconnect,\n        removeRemoteTrack\n    ]);\n    const toggleVideo = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(()=>{\n        if (!roomRef.current) return;\n        const enabled = !isVideoEnabled;\n        roomRef.current.localParticipant.setCameraEnabled(enabled);\n        setIsVideoEnabled(enabled);\n    }, [\n        isVideoEnabled\n    ]);\n    const toggleAudio = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(()=>{\n        if (!roomRef.current) return;\n        const enabled = !isAudioEnabled;\n        roomRef.current.localParticipant.setMicrophoneEnabled(enabled);\n        setIsAudioEnabled(enabled);\n    }, [\n        isAudioEnabled\n    ]);\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{\n        return ()=>{\n            disconnect();\n        };\n    }, [\n        disconnect\n    ]);\n    return {\n        room,\n        localStream,\n        remoteStreams,\n        isConnected,\n        error,\n        connect,\n        disconnect,\n        toggleVideo,\n        toggleAudio,\n        isVideoEnabled,\n        isAudioEnabled\n    };\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uLi8uLi9wYWNrYWdlcy9hcHAvaG9va3MvdXNlTGl2ZUtpdC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQWlFO0FBQytCO0FBaUN6RixTQUFTUyxXQUFXLEtBS1A7UUFMTyxFQUN6QkMsUUFBUSxFQUNSQyxLQUFLLEVBQ0xDLEdBQUcsRUFDSEMsZ0JBQWdCLElBQUksRUFDRixHQUxPO0lBTXpCLE1BQU0sQ0FBQ0MsTUFBTUMsUUFBUSxHQUFHWiwrQ0FBUUEsQ0FBYztJQUM5QyxNQUFNLENBQUNhLGFBQWFDLGVBQWUsR0FBR2QsK0NBQVFBLENBQXFCO0lBQ25FLE1BQU0sQ0FBQ2UsZUFBZUMsaUJBQWlCLEdBQUdoQiwrQ0FBUUEsQ0FBMkIsSUFBSWlCO0lBQ2pGLE1BQU0sQ0FBQ0MsY0FBY0MsZ0JBQWdCLEdBQUduQiwrQ0FBUUEsQ0FBdUMsSUFBSWlCO0lBQzNGLE1BQU0sQ0FBQ0csYUFBYUMsZUFBZSxHQUFHckIsK0NBQVFBLENBQUM7SUFDL0MsTUFBTSxDQUFDc0IsT0FBT0MsU0FBUyxHQUFHdkIsK0NBQVFBLENBQWdCO0lBQ2xELE1BQU0sQ0FBQ3dCLGdCQUFnQkMsa0JBQWtCLEdBQUd6QiwrQ0FBUUEsQ0FBQztJQUNyRCxNQUFNLENBQUMwQixnQkFBZ0JDLGtCQUFrQixHQUFHM0IsK0NBQVFBLENBQUM7SUFFckQsTUFBTTRCLFVBQVU3Qiw2Q0FBTUEsQ0FBYztJQUNwQyxNQUFNOEIsb0JBQW9COUIsNkNBQU1BLENBQXVCO0lBQ3ZELE1BQU0rQixtQkFBbUIvQiw2Q0FBTUEsQ0FBQztRQUFFUTtRQUFVQztRQUFPQztJQUFJO0lBRXZEWCxnREFBU0EsQ0FBQztRQUNSZ0MsaUJBQWlCQyxPQUFPLEdBQUc7WUFBRXhCO1lBQVVDO1lBQU9DO1FBQUk7SUFDcEQsR0FBRztRQUFDRjtRQUFVQztRQUFPQztLQUFJO0lBRXpCLE1BQU11Qiw0QkFBNEJuQyxrREFBV0EsQ0FBQyxDQUFDb0M7UUFDN0MsSUFBSTtZQUNGLE1BQU1DLGVB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b3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4uLy4uL3BhY2thZ2VzL2FwcC9ob29rcy91c2VMaXZlS2l0LnRzPzFlMjEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdXNlQ2FsbGJhY2ssIHVzZUVmZmVjdCwgdXNlUmVmLCB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IFJvb20sIFJvb21FdmVudCwgUmVtb3RlVHJhY2ssIExvY2FsVmlkZW9UcmFjaywgTG9jYWxBdWRpb1RyYWNrIH0gZnJvbSAnbGl2ZWtpdC1jbGllbnQnO1xuXG4vLyBOT1RFOiBUaGlzIGhvb2sgaXMgbm93IHdlYi1maXJzdC4gUmVhY3QgTmF0aXZlIGdsb2JhbHMgcmVnaXN0cmF0aW9uIGhhcyBiZWVuXG4vLyByZW1vdmVkIHRvIGF2b2lkIGJ1bmRsaW5nICdyZWFjdC1uYXRpdmUnIGluIE5leHQuanMuIElmIHlvdSBuZWVkIG5hdGl2ZVxuLy8gc3VwcG9ydCBsYXRlciwgY3JlYXRlIGEgc2VwYXJhdGUgJ3VzZUxpdmVLaXQubmF0aXZlLnRzJyBpbXBsZW1lbnRhdGlvbi5cblxuaW50ZXJmYWNlIFVzZUxpdmVLaXRPcHRpb25zIHtcbiAgcm9vbU5hbWU/OiBzdHJpbmc7XG4gIHRva2VuPzogc3RyaW5nO1xuICB1cmw/OiBzdHJpbmc7XG4gIGF1dG9TdWJzY3JpYmU/OiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFJlbW90ZVBhcnRpY2lwYW50VHJhY2tzIHtcbiAgYXVkaW9UcmFjaz86IFJlbW90ZVRyYWNrO1xuICB2aWRlb1RyYWNrPzogUmVtb3RlVHJhY2s7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVXNlTGl2ZUtpdFJlc3VsdCB7XG4gIHJvb206IFJvb20gfCBudWxsO1xuICBsb2NhbFN0cmVhbTogTWVkaWFTdHJlYW0gfCBudWxsO1xuICByZW1vdGVTdHJlYW1zOiBNYXA8c3RyaW5nLCBNZWRpYVN0cmVhbT47XG4gIHJlbW90ZVRyYWNrczogTWFwPHN0cmluZywgUmVtb3RlUGFydGljaXBhbnRUcmFja3M+OyAvLyBOZXc6IGZvciBkaXJlY3QgdHJhY2sgYXR0YWNobWVudFxuICBpc0Nvbm5lY3RlZDogYm9vbGVhbjtcbiAgZXJyb3I6IHN0cmluZyB8IG51bGw7XG4gIGNvbm5lY3Q6ICgpID0+IFByb21pc2U8dm9pZD47XG4gIGRpc2Nvbm5lY3Q6ICgpID0+IHZvaWQ7XG4gIHRvZ2dsZVZpZGVvOiAoKSA9PiB2b2lkO1xuICB0b2dnbGVBdWRpbzogKCkgPT4gdm9pZDtcbiAgaXNWaWRlb0VuYWJsZWQ6IGJvb2xlYW47XG4gIGlzQXVkaW9FbmFibGVkOiBib29sZWFuO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdXNlTGl2ZUtpdCh7XG4gIHJvb21OYW1lLFxuICB0b2tlbixcbiAgdXJsLFxuICBhdXRvU3Vic2NyaWJlID0gdHJ1ZSxcbn06IFVzZUxpdmVLaXRPcHRpb25zKTogVXNlTGl2ZUtpdFJlc3VsdCB7XG4gIGNvbnN0IFtyb29tLCBzZXRSb29tXSA9IHVzZVN0YXRlPFJvb20gfCBudWxsPihudWxsKTtcbiAgY29uc3QgW2xvY2FsU3RyZWFtLCBzZXRMb2NhbFN0cmVhbV0gPSB1c2VTdGF0ZTxNZWRpYVN0cmVhbSB8IG51bGw+KG51bGwpO1xuICBjb25zdCBbcmVtb3RlU3RyZWFtcywgc2V0UmVtb3RlU3RyZWFtc10gPSB1c2VTdGF0ZTxNYXA8c3RyaW5nLCBNZWRpYVN0cmVhbT4+KG5ldyBNYXAoKSk7XG4gIGNvbnN0IFtyZW1vdGVUcmFja3MsIHNldFJlbW90ZVRyYWNrc10gPSB1c2VTdGF0ZTxNYXA8c3RyaW5nLCBSZW1vdGVQYXJ0aWNpcGFudFRyYWNrcz4+KG5ldyBNYXAoKSk7XG4gIGNvbnN0IFtpc0Nvbm5lY3RlZCwgc2V0SXNDb25uZWN0ZWRdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbZXJyb3IsIHNldEVycm9yXSA9IHVzZVN0YXRlPHN0cmluZyB8IG51bGw+KG51bGwpO1xuICBjb25zdCBbaXNWaWRlb0VuYWJsZWQsIHNldElzVmlkZW9FbmFibGVkXSA9IHVzZVN0YXRlKHRydWUpO1xuICBjb25zdCBbaXNBdWRpb0VuYWJsZWQsIHNldElzQXVkaW9FbmFibGVkXSA9IHVzZVN0YXRlKHRydWUpO1xuXG4gIGNvbnN0IHJvb21SZWYgPSB1c2VSZWY8Um9vbSB8IG51bGw+KG51bGwpO1xuICBjb25zdCBjb25uZWN0UHJvbWlzZVJlZiA9IHVzZVJlZjxQcm9taXNlPHZvaWQ+IHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IGxhdGVzdE9wdGlvbnNSZWYgPSB1c2VSZWYoeyByb29tTmFtZSwgdG9rZW4sIHVybCB9KTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGxhdGVzdE9wdGlvbnNSZWYuY3VycmVudCA9IHsgcm9vbU5hbWUsIHRva2VuLCB1cmwgfTtcbiAgfSwgW3Jvb21OYW1lLCB0b2tlbiwgdXJsXSk7XG5cbiAgY29uc3QgYnVpbGRNZWRpYVN0cmVhbUZyb21Mb2NhbCA9IHVzZUNhbGxiYWNrKChjdXJyZW50Um9vbTogUm9vbSkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBwdWJsaWNhdGlvbnMgPSBBcnJheS5mcm9tKGN1cnJlbnRSb29tLmxvY2FsUGFydGljaXBhbnQudHJhY2tQdWJsaWNhdGlvbnMudmFsdWVzKCkpO1xuICAgICAgY29uc3QgdHJhY2tzOiBNZWRpYVN0cmVhbVRyYWNrW10gPSBbXTtcbiAgICAgIHB1YmxpY2F0aW9ucy5mb3JFYWNoKChwdWIpID0+IHtcbiAgICAgICAgY29uc3QgbGtUcmFjayA9IHB1Yi50cmFjaztcbiAgICAgICAgaWYgKFxuICAgICAgICAgIGxrVHJhY2sgJiZcbiAgICAgICAgICAobGtUcmFjayBpbnN0YW5jZW9mIExvY2FsVmlkZW9UcmFjayB8fCBsa1RyYWNrIGluc3RhbmNlb2YgTG9jYWxBdWRpb1RyYWNrKVxuICAgICAgICApIHtcbiAgICAgICAgICBjb25zdCBtZWRpYVRyYWNrID0gKGxrVHJhY2sgYXMgYW55KS5tZWRpYVN0cmVhbVRyYWNrIGFzIE1lZGlhU3RyZWFtVHJhY2sgfCB1bmRlZmluZWQ7XG4gICAgICAgICAgaWYgKG1lZGlhVHJhY2spIHtcbiAgICAgICAgICAgIHRyYWNrcy5wdXNoKG1lZGlhVHJhY2spO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBpZiAodHJhY2tzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc3Qgc3RyZWFtID0gbmV3IE1lZGlhU3RyZWFtKHRyYWNrcyk7XG4gICAgICAgIHNldExvY2FsU3RyZWFtKHN0cmVhbSk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ1tMaXZlS2l0XSBGYWlsZWQgdG8gYnVpbGQgbG9jYWwgc3RyZWFtOicsIGVycik7XG4gICAgfVxuICB9LCBbXSk7XG5cbiAgY29uc3QgYWRkUmVtb3RlVHJhY2sgPSB1c2VDYWxsYmFjaygocGFydGljaXBhbnRJZDogc3RyaW5nLCBtZWRpYVRyYWNrOiBNZWRpYVN0cmVhbVRyYWNrKSA9PiB7XG4gICAgc2V0UmVtb3RlU3RyZWFtcygocHJldikgPT4ge1xuICAgICAgY29uc3QgbmV4dCA9IG5ldyBNYXAocHJldik7XG4gICAgICBjb25zdCBleGlzdGluZyA9IG5leHQuZ2V0KHBhcnRpY2lwYW50SWQpO1xuICAgICAgXG4gICAgICAvLyBDcmVhdGUgYSBORVcgTWVkaWFTdHJlYW0gd2l0aCBhbGwgZXhpc3RpbmcgdHJhY2tzICsgbmV3IHRyYWNrXG4gICAgICAvLyBUaGlzIGVuc3VyZXMgUmVhY3QgZGV0ZWN0cyB0aGUgc3RhdGUgY2hhbmdlXG4gICAgICBjb25zdCBhbGxUcmFja3M6IE1lZGlhU3RyZWFtVHJhY2tbXSA9IFtdO1xuICAgICAgaWYgKGV4aXN0aW5nKSB7XG4gICAgICAgIGV4aXN0aW5nLmdldFRyYWNrcygpLmZvckVhY2godCA9PiB7XG4gICAgICAgICAgaWYgKHQuaWQgIT09IG1lZGlhVHJhY2suaWQpIHtcbiAgICAgICAgICAgIGFsbFRyYWNrcy5wdXNoKHQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBhbGxUcmFja3MucHVzaChtZWRpYVRyYWNrKTtcbiAgICAgIFxuICAgICAgY29uc3QgbmV3U3RyZWFtID0gbmV3IE1lZGlhU3RyZWFtKGFsbFRyYWNrcyk7XG4gICAgICBuZXh0LnNldChwYXJ0aWNpcGFudElkLCBuZXdTdHJlYW0pO1xuICAgICAgXG4gICAgICBjb25zb2xlLmxvZygnW0xpdmVLaXRdIFJlbW90ZSBzdHJlYW1zIHVwZGF0ZWQ6Jywge1xuICAgICAgICBwYXJ0aWNpcGFudElkLFxuICAgICAgICBuZXdUcmFja0tpbmQ6IG1lZGlhVHJhY2sua2luZCxcbiAgICAgICAgdG90YWxUcmFja3M6IG5ld1N0cmVhbS5nZXRUcmFja3MoKS5sZW5ndGgsXG4gICAgICAgIG1hcFNpemU6IG5leHQuc2l6ZVxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIHJldHVybiBuZXh0O1xuICAgIH0pO1xuICB9LCBbXSk7XG5cbiAgY29uc3QgcmVtb3ZlUmVtb3RlVHJhY2sgPSB1c2VDYWxsYmFjaygocGFydGljaXBhbnRJZDogc3RyaW5nLCBtZWRpYVRyYWNrPzogTWVkaWFTdHJlYW1UcmFjaykgPT4ge1xuICAgIHNldFJlbW90ZVN0cmVhbXMoKHByZXYpID0+IHtcbiAgICAgIGNvbnN0IG5leHQgPSBuZXcgTWFwKHByZXYpO1xuICAgICAgY29uc3QgZXhpc3RpbmcgPSBuZXh0LmdldChwYXJ0aWNpcGFudElkKTtcbiAgICAgIGlmICghZXhpc3RpbmcpIHJldHVybiBwcmV2O1xuICAgICAgaWYgKG1lZGlhVHJhY2spIHtcbiAgICAgICAgZXhpc3RpbmcucmVtb3ZlVHJhY2sobWVkaWFUcmFjayk7XG4gICAgICB9XG4gICAgICBpZiAoZXhpc3RpbmcuZ2V0VHJhY2tzKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIG5leHQuZGVsZXRlKHBhcnRpY2lwYW50SWQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbmV4dC5zZXQocGFydGljaXBhbnRJZCwgZXhpc3RpbmcpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG5leHQ7XG4gICAgfSk7XG4gIH0sIFtdKTtcblxuICBjb25zdCBkaXNjb25uZWN0ID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIGlmIChyb29tUmVmLmN1cnJlbnQpIHtcbiAgICAgIHJvb21SZWYuY3VycmVudC5kaXNjb25uZWN0KCk7XG4gICAgICByb29tUmVmLmN1cnJlbnQgPSBudWxsO1xuICAgIH1cbiAgICBjb25uZWN0UHJvbWlzZVJlZi5jdXJyZW50ID0gbnVsbDtcbiAgICBzZXRSb29tKG51bGwpO1xuICAgIHNldElzQ29ubmVjdGVkKGZhbHNlKTtcbiAgICBzZXRMb2NhbFN0cmVhbShudWxsKTtcbiAgICBzZXRSZW1vdGVTdHJlYW1zKG5ldyBNYXAoKSk7XG4gICAgc2V0RXJyb3IobnVsbCk7XG4gIH0sIFtdKTtcblxuICBjb25zdCBjb25uZWN0ID0gdXNlQ2FsbGJhY2soYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IHsgcm9vbU5hbWU6IGN1cnJlbnRSb29tTmFtZSwgdG9rZW46IGN1cnJlbnRUb2tlbiwgdXJsOiBjdXJyZW50VXJsIH0gPVxuICAgICAgbGF0ZXN0T3B0aW9uc1JlZi5jdXJyZW50O1xuXG4gICAgaWYgKCFjdXJyZW50Um9vbU5hbWUgfHwgIWN1cnJlbnRUb2tlbiB8fCAhY3VycmVudFVybCkge1xuICAgICAgc2V0RXJyb3IoJ1RoaeG6v3UgdGjDtG5nIHRpbiBMaXZlS2l0IChyb29tL3Rva2VuL3VybCknKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAocm9vbVJlZi5jdXJyZW50ICYmIHJvb21SZWYuY3VycmVudC5zdGF0ZSA9PT0gJ2Nvbm5lY3RlZCcpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoY29ubmVjdFByb21pc2VSZWYuY3VycmVudCkge1xuICAgICAgcmV0dXJuIGNvbm5lY3RQcm9taXNlUmVmLmN1cnJlbnQ7XG4gICAgfVxuXG4gICAgY29uc3QgcHJvbWlzZSA9IChhc3luYyAoKSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBzZXRFcnJvcihudWxsKTtcbiAgICAgICAgY29uc3QgbmV3Um9vbSA9IG5ldyBSb29tKHtcbiAgICAgICAgICBhZGFwdGl2ZVN0cmVhbTogdHJ1ZSxcbiAgICAgICAgICBkeW5hY2FzdDogdHJ1ZSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcm9vbVJlZi5jdXJyZW50ID0gbmV3Um9vbTtcbiAgICAgICAgc2V0Um9vbShuZXdSb29tKTtcblxuICAgICAgICBuZXdSb29tLm9uKFJvb21FdmVudC5Db25uZWN0ZWQsICgpID0+IHtcbiAgICAgICAgICBzZXRJc0Nvbm5lY3RlZCh0cnVlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgbmV3Um9vbS5vbihSb29tRXZlbnQuRGlzY29ubmVjdGVkLCAoKSA9PiB7XG4gICAgICAgICAgc2V0SXNDb25uZWN0ZWQoZmFsc2UpO1xuICAgICAgICAgIHNldExvY2FsU3RyZWFtKG51bGwpO1xuICAgICAgICAgIHNldFJlbW90ZVN0cmVhbXMobmV3IE1hcCgpKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgbmV3Um9vbS5vbihSb29tRXZlbnQuVHJhY2tTdWJzY3JpYmVkLCAodHJhY2ssIHB1YmxpY2F0aW9uLCBwYXJ0aWNpcGFudCkgPT4ge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdbTGl2ZUtpdF0gVHJhY2tTdWJzY3JpYmVkOicsIHtcbiAgICAgICAgICAgIHRyYWNrS2luZDogdHJhY2sua2luZCxcbiAgICAgICAgICAgIHBhcnRpY2lwYW50SWQ6IHBhcnRpY2lwYW50LmlkZW50aXR5LFxuICAgICAgICAgICAgcGFydGljaXBhbnRTaWQ6IHBhcnRpY2lwYW50LnNpZCxcbiAgICAgICAgICAgIHRyYWNrU2lkOiB0cmFjay5zaWQsXG4gICAgICAgICAgICBpc011dGVkOiBwdWJsaWNhdGlvbi5pc011dGVkLFxuICAgICAgICAgICAgaXNTdWJzY3JpYmVkOiBwdWJsaWNhdGlvbi5pc1N1YnNjcmliZWRcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBpZiAodHJhY2sgaW5zdGFuY2VvZiBSZW1vdGVUcmFjaykge1xuICAgICAgICAgICAgLy8gVXNlIExpdmVLaXQncyBhdHRhY2ggbWV0aG9kIHRvIGdldCBhIHByb3Blcmx5IGluaXRpYWxpemVkIHZpZGVvIGVsZW1lbnRcbiAgICAgICAgICAgIC8vIFRoZW4gZXh0cmFjdCB0aGUgc3RyZWFtIGZyb20gaXRcbiAgICAgICAgICAgIGNvbnN0IHRlbXBFbGVtZW50ID0gdHJhY2suYXR0YWNoKCk7XG4gICAgICAgICAgICBjb25zdCBtZWRpYVN0cmVhbSA9ICh0ZW1wRWxlbWVudCBhcyBIVE1MVmlkZW9FbGVtZW50KS5zcmNPYmplY3QgYXMgTWVkaWFTdHJlYW0gfCBudWxsO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAobWVkaWFTdHJlYW0pIHtcbiAgICAgICAgICAgICAgY29uc3QgdmlkZW9UcmFjayA9IG1lZGlhU3RyZWFtLmdldFZpZGVvVHJhY2tzKClbMF07XG4gICAgICAgICAgICAgIGNvbnN0IGF1ZGlvVHJhY2sgPSBtZWRpYVN0cmVhbS5nZXRBdWRpb1RyYWNrcygpWzBdO1xuICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1tMaXZlS2l0XSBHb3QgTWVkaWFTdHJlYW0gZnJvbSBhdHRhY2hlZCBlbGVtZW50OicsIHtcbiAgICAgICAgICAgICAgICBwYXJ0aWNpcGFudElkOiBwYXJ0aWNpcGFudC5pZGVudGl0eSxcbiAgICAgICAgICAgICAgICB0cmFja0tpbmQ6IHRyYWNrLmtpbmQsXG4gICAgICAgICAgICAgICAgc3RyZWFtSWQ6IG1lZGlhU3RyZWFtLmlkLFxuICAgICAgICAgICAgICAgIHZpZGVvVHJhY2tzOiBtZWRpYVN0cmVhbS5nZXRWaWRlb1RyYWNrcygpLmxlbmd0aCxcbiAgICAgICAgICAgICAgICBhdWRpb1RyYWNrczogbWVkaWFTdHJlYW0uZ2V0QXVkaW9UcmFja3MoKS5sZW5ndGgsXG4gICAgICAgICAgICAgICAgdmlkZW9NdXRlZDogdmlkZW9UcmFjaz8ubXV0ZWQsXG4gICAgICAgICAgICAgICAgYXVkaW9NdXRlZDogYXVkaW9UcmFjaz8ubXV0ZWRcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAvLyBBZGQgYWxsIHRyYWNrcyBmcm9tIHRoZSBhdHRhY2hlZCBzdHJlYW1cbiAgICAgICAgICAgICAgbWVkaWFTdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaChtZWRpYVRyYWNrID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnW0xpdmVLaXRdIEFkZGluZyBhdHRhY2hlZCB0cmFjazonLCB7XG4gICAgICAgICAgICAgICAgICBwYXJ0aWNpcGFudElkOiBwYXJ0aWNpcGFudC5pZGVudGl0eSxcbiAgICAgICAgICAgICAgICAgIHRyYWNrS2luZDogbWVkaWFUcmFjay5raW5kLFxuICAgICAgICAgICAgICAgICAgdHJhY2tFbmFibGVkOiBtZWRpYVRyYWNrLmVuYWJsZWQsXG4gICAgICAgICAgICAgICAgICB0cmFja011dGVkOiBtZWRpYVRyYWNrLm11dGVkXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgYWRkUmVtb3RlVHJhY2socGFydGljaXBhbnQuaWRlbnRpdHksIG1lZGlhVHJhY2spO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIC8vIERldGFjaCB0aGUgdGVtcCBlbGVtZW50IHNpbmNlIHdlIG9ubHkgbmVlZGVkIHRoZSBzdHJlYW1cbiAgICAgICAgICAgICAgdHJhY2suZGV0YWNoKHRlbXBFbGVtZW50KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIC8vIEZhbGxiYWNrIHRvIG9sZCBtZXRob2RcbiAgICAgICAgICAgICAgY29uc3QgbWVkaWFUcmFjayA9ICh0cmFjayBhcyBhbnkpLm1lZGlhU3RyZWFtVHJhY2sgYXMgTWVkaWFTdHJlYW1UcmFjayB8IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgaWYgKG1lZGlhVHJhY2spIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnW0xpdmVLaXRdIEZhbGxiYWNrOiBBZGRpbmcgcmVtb3RlIHRyYWNrIGRpcmVjdGx5OicsIHtcbiAgICAgICAgICAgICAgICAgIHBhcnRpY2lwYW50SWQ6IHBhcnRpY2lwYW50LmlkZW50aXR5LFxuICAgICAgICAgICAgICAgICAgdHJhY2tJZDogbWVkaWFUcmFjay5pZCxcbiAgICAgICAgICAgICAgICAgIHRyYWNrS2luZDogbWVkaWFUcmFjay5raW5kXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgYWRkUmVtb3RlVHJhY2socGFydGljaXBhbnQuaWRlbnRpdHksIG1lZGlhVHJhY2spO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIEhhbmRsZSB0cmFjayBtdXRlZC91bm11dGVkIGV2ZW50cyBmcm9tIHJlbW90ZSBwYXJ0aWNpcGFudHNcbiAgICAgICAgbmV3Um9vbS5vbihSb29tRXZlbnQuVHJhY2tNdXRlZCwgKHB1YmxpY2F0aW9uLCBwYXJ0aWNpcGFudCkgPT4ge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdbTGl2ZUtpdF0gVHJhY2tNdXRlZDonLCB7XG4gICAgICAgICAgICB0cmFja0tpbmQ6IHB1YmxpY2F0aW9uLmtpbmQsXG4gICAgICAgICAgICBwYXJ0aWNpcGFudElkOiBwYXJ0aWNpcGFudC5pZGVudGl0eSxcbiAgICAgICAgICAgIHNvdXJjZTogcHVibGljYXRpb24uc291cmNlXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgbmV3Um9vbS5vbihSb29tRXZlbnQuVHJhY2tVbm11dGVkLCAocHVibGljYXRpb24sIHBhcnRpY2lwYW50KSA9PiB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ1tMaXZlS2l0XSBUcmFja1VubXV0ZWQ6Jywge1xuICAgICAgICAgICAgdHJhY2tLaW5kOiBwdWJsaWNhdGlvbi5raW5kLFxuICAgICAgICAgICAgcGFydGljaXBhbnRJZDogcGFydGljaXBhbnQuaWRlbnRpdHksXG4gICAgICAgICAgICBzb3VyY2U6IHB1YmxpY2F0aW9uLnNvdXJjZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIC8vIFJlLWFkZCB0cmFjayB3aGVuIHVubXV0ZWRcbiAgICAgICAgICBpZiAocHVibGljYXRpb24udHJhY2sgaW5zdGFuY2VvZiBSZW1vdGVUcmFjaykge1xuICAgICAgICAgICAgY29uc3QgbWVkaWFUcmFjayA9IChwdWJsaWNhdGlvbi50cmFjayBhcyBhbnkpLm1lZGlhU3RyZWFtVHJhY2sgYXMgTWVkaWFTdHJlYW1UcmFjayB8IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIGlmIChtZWRpYVRyYWNrKSB7XG4gICAgICAgICAgICAgIGFkZFJlbW90ZVRyYWNrKHBhcnRpY2lwYW50LmlkZW50aXR5LCBtZWRpYVRyYWNrKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgbmV3Um9vbS5vbihSb29tRXZlbnQuUGFydGljaXBhbnRDb25uZWN0ZWQsIChwYXJ0aWNpcGFudCkgPT4ge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdbTGl2ZUtpdF0gUGFydGljaXBhbnRDb25uZWN0ZWQ6Jywge1xuICAgICAgICAgICAgcGFydGljaXBhbnRJZDogcGFydGljaXBhbnQuaWRlbnRpdHksXG4gICAgICAgICAgICBwYXJ0aWNpcGFudFNpZDogcGFydGljaXBhbnQuc2lkLFxuICAgICAgICAgICAgdHJhY2tDb3VudDogcGFydGljaXBhbnQudHJhY2tQdWJsaWNhdGlvbnMuc2l6ZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBuZXdSb29tLm9uKFJvb21FdmVudC5UcmFja1Vuc3Vic2NyaWJlZCwgKHRyYWNrLCBwdWJsaWNhdGlvbiwgcGFydGljaXBhbnQpID0+IHtcbiAgICAgICAgICBpZiAodHJhY2sgaW5zdGFuY2VvZiBSZW1vdGVUcmFjaykge1xuICAgICAgICAgICAgY29uc3QgbWVkaWFUcmFjayA9ICh0cmFjayBhcyBhbnkpLm1lZGlhU3RyZWFtVHJhY2sgYXMgTWVkaWFTdHJlYW1UcmFjayB8IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHJlbW92ZVJlbW90ZVRyYWNrKHBhcnRpY2lwYW50LmlkZW50aXR5LCBtZWRpYVRyYWNrKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIG5ld1Jvb20ub24oUm9vbUV2ZW50LlBhcnRpY2lwYW50RGlzY29ubmVjdGVkLCAocGFydGljaXBhbnQpID0+IHtcbiAgICAgICAgICBzZXRSZW1vdGVTdHJlYW1zKChwcmV2KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuZXh0ID0gbmV3IE1hcChwcmV2KTtcbiAgICAgICAgICAgIG5leHQuZGVsZXRlKHBhcnRpY2lwYW50LmlkZW50aXR5KTtcbiAgICAgICAgICAgIHJldHVybiBuZXh0O1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBjb25zb2xlLmxvZygnW0xpdmVLaXRdIENvbm5lY3RpbmcgdG8gcm9vbTonLCBjdXJyZW50Um9vbU5hbWUsICdhdCBVUkw6JywgY3VycmVudFVybCk7XG4gICAgICAgIGF3YWl0IG5ld1Jvb20uY29ubmVjdChjdXJyZW50VXJsLCBjdXJyZW50VG9rZW4pO1xuICAgICAgICBjb25zb2xlLmxvZygnW0xpdmVLaXRdIENvbm5lY3RlZCEgUm9vbSBzdGF0ZTonLCBuZXdSb29tLnN0YXRlKTtcbiAgICAgICAgY29uc29sZS5sb2coJ1tMaXZlS2l0XSBSZW1vdGUgcGFydGljaXBhbnRzOicsIG5ld1Jvb20ucmVtb3RlUGFydGljaXBhbnRzLnNpemUpO1xuICAgICAgICBcbiAgICAgICAgLy8gTG9nIGV4aXN0aW5nIHJlbW90ZSBwYXJ0aWNpcGFudHNcbiAgICAgICAgbmV3Um9vbS5yZW1vdGVQYXJ0aWNpcGFudHMuZm9yRWFjaCgocGFydGljaXBhbnQsIHNpZCkgPT4ge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdbTGl2ZUtpdF0gRXhpc3RpbmcgcmVtb3RlIHBhcnRpY2lwYW50OicsIHtcbiAgICAgICAgICAgIGlkZW50aXR5OiBwYXJ0aWNpcGFudC5pZGVudGl0eSxcbiAgICAgICAgICAgIHNpZDogc2lkLFxuICAgICAgICAgICAgdHJhY2tDb3VudDogcGFydGljaXBhbnQudHJhY2tQdWJsaWNhdGlvbnMuc2l6ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIC8vIFN1YnNjcmliZSB0byBhbnkgZXhpc3RpbmcgdHJhY2tzXG4gICAgICAgICAgcGFydGljaXBhbnQudHJhY2tQdWJsaWNhdGlvbnMuZm9yRWFjaCgocHViKSA9PiB7XG4gICAgICAgICAgICBpZiAocHViLnRyYWNrICYmIHB1Yi50cmFjayBpbnN0YW5jZW9mIFJlbW90ZVRyYWNrKSB7XG4gICAgICAgICAgICAgIGNvbnN0IG1lZGlhVHJhY2sgPSAocHViLnRyYWNrIGFzIGFueSkubWVkaWFTdHJlYW1UcmFjayBhcyBNZWRpYVN0cmVhbVRyYWNrIHwgdW5kZWZpbmVkO1xuICAgICAgICAgICAgICBpZiAobWVkaWFUcmFjaykge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbTGl2ZUtpdF0gRm91bmQgZXhpc3RpbmcgcmVtb3RlIHRyYWNrOicsIHtcbiAgICAgICAgICAgICAgICAgIHBhcnRpY2lwYW50SWQ6IHBhcnRpY2lwYW50LmlkZW50aXR5LFxuICAgICAgICAgICAgICAgICAgdHJhY2tJZDogbWVkaWFUcmFjay5pZCxcbiAgICAgICAgICAgICAgICAgIHRyYWNrS2luZDogbWVkaWFUcmFjay5raW5kXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgYWRkUmVtb3RlVHJhY2socGFydGljaXBhbnQuaWRlbnRpdHksIG1lZGlhVHJhY2spO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgYXdhaXQgbmV3Um9vbS5sb2NhbFBhcnRpY2lwYW50LmVuYWJsZUNhbWVyYUFuZE1pY3JvcGhvbmUoKTtcbiAgICAgICAgY29uc29sZS5sb2coJ1tMaXZlS2l0XSBDYW1lcmEgYW5kIG1pY3JvcGhvbmUgZW5hYmxlZCcpO1xuICAgICAgICBidWlsZE1lZGlhU3RyZWFtRnJvbUxvY2FsKG5ld1Jvb20pO1xuICAgICAgfSBjYXRjaCAoZXJyOiBhbnkpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignW0xpdmVLaXRdIEVycm9yIGNvbm5lY3Rpbmc6JywgZXJyKTtcbiAgICAgICAgc2V0RXJyb3IoZXJyPy5tZXNzYWdlIHx8ICdLaMO0bmcgdGjhu4Mga+G6v3QgbuG7kWkgTGl2ZUtpdCcpO1xuICAgICAgICBkaXNjb25uZWN0KCk7XG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICBjb25uZWN0UHJvbWlzZVJlZi5jdXJyZW50ID0gbnVsbDtcbiAgICAgIH1cbiAgICB9KSgpO1xuXG4gICAgY29ubmVjdFByb21pc2VSZWYuY3VycmVudCA9IHByb21pc2U7XG4gICAgcmV0dXJuIHByb21pc2U7XG4gIH0sIFthZGRSZW1vdGVUcmFjaywgYXV0b1N1YnNjcmliZSwgYnVpbGRNZWRpYVN0cmVhbUZyb21Mb2NhbCwgZGlzY29ubmVjdCwgcmVtb3ZlUmVtb3RlVHJhY2tdKTtcblxuICBjb25zdCB0b2dnbGVWaWRlbyA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICBpZiAoIXJvb21SZWYuY3VycmVudCkgcmV0dXJuO1xuICAgIGNvbnN0IGVuYWJsZWQgPSAhaXNWaWRlb0VuYWJsZWQ7XG4gICAgcm9vbVJlZi5jdXJyZW50LmxvY2FsUGFydGljaXBhbnQuc2V0Q2FtZXJhRW5hYmxlZChlbmFibGVkKTtcbiAgICBzZXRJc1ZpZGVvRW5hYmxlZChlbmFibGVkKTtcbiAgfSwgW2lzVmlkZW9FbmFibGVkXSk7XG5cbiAgY29uc3QgdG9nZ2xlQXVkaW8gPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgaWYgKCFyb29tUmVmLmN1cnJlbnQpIHJldHVybjtcbiAgICBjb25zdCBlbmFibGVkID0gIWlzQXVkaW9FbmFibGVkO1xuICAgIHJvb21SZWYuY3VycmVudC5sb2NhbFBhcnRpY2lwYW50LnNldE1pY3JvcGhvbmVFbmFibGVkKGVuYWJsZWQpO1xuICAgIHNldElzQXVkaW9FbmFibGVkKGVuYWJsZWQpO1xuICB9LCBbaXNBdWRpb0VuYWJsZWRdKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBkaXNjb25uZWN0KCk7XG4gICAgfTtcbiAgfSwgW2Rpc2Nvbm5lY3RdKTtcblxuICByZXR1cm4ge1xuICAgIHJvb20sXG4gICAgbG9jYWxTdHJlYW0sXG4gICAgcmVtb3RlU3RyZWFtcyxcbiAgICBpc0Nvbm5lY3RlZCxcbiAgICBlcnJvcixcbiAgICBjb25uZWN0LFxuICAgIGRpc2Nvbm5lY3QsXG4gICAgdG9nZ2xlVmlkZW8sXG4gICAgdG9nZ2xlQXVkaW8sXG4gICAgaXNWaWRlb0VuYWJsZWQsXG4gICAgaXNBdWRpb0VuYWJsZWQsXG4gIH07XG59XG5cbiJdLCJuYW1lcyI6WyJ1c2VDYWxsYmFjayIsInVzZUVmZmVjdCIsInVzZVJlZiIsInVzZVN0YXRlIiwiUm9vbSIsIlJvb21FdmVudCIsIlJlbW90ZVRyYWNrIiwiTG9jYWxWaWRlb1RyYWNrIiwiTG9jYWxBdWRpb1RyYWNrIiwidXNlTGl2ZUtpdCIsInJvb21OYW1lIiwidG9rZW4iLCJ1cmwiLCJhdXRvU3Vic2NyaWJlIiwicm9vbSIsInNldFJvb20iLCJsb2NhbFN0cmVhbSIsInNldExvY2FsU3RyZWFtIiwicmVtb3RlU3RyZWFtcyIsInNldFJlbW90ZVN0cmVhbXMiLCJNYXAiLCJyZW1vdGVUcmFja3MiLCJzZXRSZW1vdGVUcmFja3MiLCJpc0Nvbm5lY3RlZCIsInNldElzQ29ubmVjdGVkIiwiZXJyb3IiLCJzZXRFcnJvciIsImlzVmlkZW9FbmFibGVkIiwic2V0SXNWaWRlb0VuYWJsZWQiLCJpc0F1ZGlvRW5hYmxlZCIsInNldElzQXVkaW9FbmFibGVkIiwicm9vbVJlZiIsImNvbm5lY3RQcm9taXNlUmVmIiwibGF0ZXN0T3B0aW9uc1JlZiIsImN1cnJlbnQiLCJidWlsZE1lZGlhU3RyZWFtRnJvbUxvY2FsIiwiY3VycmVudFJvb20iLCJwdWJsaWNhdGlvbnMiLCJBcnJheSIsImZyb20iLCJsb2NhbFBhcnRpY2lwYW50IiwidHJhY2tQdWJsaWNhdGlvbnMiLCJ2YWx1ZXMiLCJ0cmFja3MiLCJmb3JFYWNoIiwicHViIiwibGtUcmFjayIsInRyYWNrIiwibWVkaWFUcmFjayIsIm1lZGlhU3RyZWFtVHJhY2siLCJwdXNoIiwibGVuZ3RoIiwic3RyZWFtIiwiTWVkaWFTdHJlYW0iLCJlcnIiLCJjb25zb2xlIiwid2FybiIsImFkZFJlbW90ZVRyYWNrIiwicGFydGljaXBhbnRJZCIsInByZXYiLCJuZXh0IiwiZXhpc3RpbmciLCJnZXQiLCJhbGxUcmFja3MiLCJnZXRUcmFja3MiLCJ0IiwiaWQiLCJuZXdTdHJlYW0iLCJzZXQiLCJsb2ciLCJuZXdUcmFja0tpbmQiLCJraW5kIiwidG90YWxUcmFja3MiLCJtYXBTaXplIiwic2l6ZSIsInJlbW92ZVJlbW90ZVRyYWNrIiwicmVtb3ZlVHJhY2siLCJkZWxldGUiLCJkaXNjb25uZWN0IiwiY29ubmVjdCIsImN1cnJlbnRSb29tTmFtZSIsImN1cnJlbnRUb2tlbiIsImN1cnJlbnRVcmwiLCJzdGF0ZSIsInByb21pc2UiLCJuZXdSb29tIiwiYWRhcHRpdmVTdHJlYW0iLCJkeW5hY2FzdCIsIm9uIiwiQ29ubmVjdGVkIiwiRGlzY29ubmVjdGVkIiwiVHJhY2tTdWJzY3JpYmVkIiwicHVibGljYXRpb24iLCJwYXJ0aWNpcGFudCIsInRyYWNrS2luZCIsImlkZW50aXR5IiwicGFydGljaXBhbnRTaWQiLCJzaWQiLCJ0cmFja1NpZCIsImlzTXV0ZWQiLCJpc1N1YnNjcmliZWQiLCJ0ZW1wRWxlbWVudCIsImF0dGFjaCIsIm1lZGlhU3RyZWFtIiwic3JjT2JqZWN0IiwidmlkZW9UcmFjayIsImdldFZpZGVvVHJhY2tzIiwiYXVkaW9UcmFjayIsImdldEF1ZGlvVHJhY2tzIiwic3RyZWFtSWQiLCJ2aWRlb1RyYWNrcyIsImF1ZGlvVHJhY2tzIiwidmlkZW9NdXRlZCIsIm11dGVkIiwiYXVkaW9NdXRlZCIsInRyYWNrRW5hYmxlZCIsImVuYWJsZWQiLCJ0cmFja011dGVkIiwiZGV0YWNoIiwidHJhY2tJZCIsIlRyYWNrTXV0ZWQiLCJzb3VyY2UiLCJUcmFja1VubXV0ZWQiLCJQYXJ0aWNpcGFudENvbm5lY3RlZCIsInRyYWNrQ291bnQiLCJUcmFja1Vuc3Vic2NyaWJlZCIsIlBhcnRpY2lwYW50RGlzY29ubmVjdGVkIiwicmVtb3RlUGFydGljaXBhbnRzIiwiZW5hYmxlQ2FtZXJhQW5kTWljcm9waG9uZSIsIm1lc3NhZ2UiLCJ0b2dnbGVWaWRlbyIsInNldENhbWVyYUVuYWJsZWQiLCJ0b2dnbGVBdWRpbyIsInNldE1pY3JvcGhvbmVFbmFibGVkIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/../../packages/app/hooks/useLiveKit.ts\n"));

/***/ })

});